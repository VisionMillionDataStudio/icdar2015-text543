# æ–‡æœ¬æ£€æµ‹æ£€æµ‹ç³»ç»Ÿæºç åˆ†äº«
 # [ä¸€æ¡é¾™æ•™å­¦YOLOV8æ ‡æ³¨å¥½çš„æ•°æ®é›†ä¸€é”®è®­ç»ƒ_70+å…¨å¥—æ”¹è¿›åˆ›æ–°ç‚¹å‘åˆŠ_Webå‰ç«¯å±•ç¤º]

### 1.ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

é¡¹ç›®å‚è€ƒ[AAAI Association for the Advancement of Artificial Intelligence](https://gitee.com/qunshansj/projects)

é¡¹ç›®æ¥æº[AACV Association for the Advancement of Computer Vision](https://gitee.com/qunmasj/projects)

ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

éšç€ä¿¡æ¯æŠ€æœ¯çš„è¿…çŒ›å‘å±•ï¼Œæ–‡æœ¬ä¿¡æ¯çš„è·å–ä¸å¤„ç†åœ¨å„ä¸ªé¢†åŸŸä¸­å˜å¾—æ„ˆå‘é‡è¦ã€‚å°¤å…¶æ˜¯åœ¨å›¾åƒå¤„ç†å’Œè®¡ç®—æœºè§†è§‰é¢†åŸŸï¼Œæ–‡æœ¬æ£€æµ‹æŠ€æœ¯çš„åº”ç”¨èŒƒå›´å¹¿æ³›ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºè‡ªåŠ¨é©¾é©¶ã€æ™ºèƒ½ç›‘æ§ã€æ–‡æ¡£æ•°å­—åŒ–å’Œå¢å¼ºç°å®ç­‰åœºæ™¯ã€‚è¿‘å¹´æ¥ï¼Œæ·±åº¦å­¦ä¹ æŠ€æœ¯çš„è¿›æ­¥ä¸ºæ–‡æœ¬æ£€æµ‹æä¾›äº†æ–°çš„è§£å†³æ–¹æ¡ˆï¼Œå…¶ä¸­YOLOï¼ˆYou Only Look Onceï¼‰ç³»åˆ—æ¨¡å‹å› å…¶é«˜æ•ˆæ€§å’Œå®æ—¶æ€§å—åˆ°å¹¿æ³›å…³æ³¨ã€‚YOLOv8ä½œä¸ºè¯¥ç³»åˆ—çš„æœ€æ–°ç‰ˆæœ¬ï¼Œè¿›ä¸€æ­¥æå‡äº†ç›®æ ‡æ£€æµ‹çš„ç²¾åº¦å’Œé€Ÿåº¦ï¼Œä½†åœ¨å¤æ‚åœºæ™¯ä¸‹çš„æ–‡æœ¬æ£€æµ‹ä»é¢ä¸´è¯¸å¤šæŒ‘æˆ˜ã€‚å› æ­¤ï¼ŒåŸºäºæ”¹è¿›YOLOv8çš„æ–‡æœ¬æ£€æµ‹ç³»ç»Ÿçš„ç ”ç©¶å…·æœ‰é‡è¦çš„å­¦æœ¯ä»·å€¼å’Œåº”ç”¨å‰æ™¯ã€‚

ICDAR 2015æ–‡æœ¬æ£€æµ‹æ•°æ®é›†æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„åŸºå‡†æ•°æ®é›†ï¼ŒåŒ…å«2100å¹…å›¾åƒï¼Œä¸“æ³¨äºæ–‡æœ¬çš„æ£€æµ‹ä¸è¯†åˆ«ã€‚è¯¥æ•°æ®é›†çš„ç‹¬ç‰¹ä¹‹å¤„åœ¨äºå…¶å¤šæ ·åŒ–çš„æ–‡æœ¬åœºæ™¯ï¼ŒåŒ…æ‹¬è‡ªç„¶åœºæ™¯ä¸­çš„æ–‡æœ¬ã€è¡—é“æ ‡è¯†ã€å¹¿å‘Šç‰Œç­‰ï¼Œæå¤§åœ°ä¸°å¯Œäº†æ¨¡å‹è®­ç»ƒå’Œè¯„ä¼°çš„ç¯å¢ƒã€‚é€šè¿‡å¯¹è¯¥æ•°æ®é›†çš„æ·±å…¥åˆ†æä¸åº”ç”¨ï¼Œç ”ç©¶è€…å¯ä»¥æ›´å¥½åœ°ç†è§£æ–‡æœ¬åœ¨ä¸åŒèƒŒæ™¯ä¸‹çš„è¡¨ç°ç‰¹å¾ï¼Œä»è€Œä¸ºæ”¹è¿›YOLOv8æ¨¡å‹æä¾›æœ‰åŠ›çš„æ•°æ®æ”¯æŒã€‚æ•°æ®é›†ä¸­åªæœ‰ä¸€ä¸ªç±»åˆ«ï¼Œå³â€œæ–‡æœ¬â€ï¼Œè¿™ä½¿å¾—ç ”ç©¶è€…èƒ½å¤Ÿä¸“æ³¨äºæ–‡æœ¬æ£€æµ‹çš„ç²¾åº¦æå‡ï¼Œè€Œä¸å¿…åˆ†æ•£ç²¾åŠ›äºå…¶ä»–ç±»åˆ«çš„ç›®æ ‡æ£€æµ‹ã€‚

åœ¨å½“å‰çš„ç ”ç©¶èƒŒæ™¯ä¸‹ï¼Œæ–‡æœ¬æ£€æµ‹ç³»ç»Ÿçš„æ€§èƒ½ä¸ä»…ä¾èµ–äºæ¨¡å‹çš„æ¶æ„è®¾è®¡ï¼Œè¿˜å—åˆ°æ•°æ®é›†è´¨é‡å’Œå¤šæ ·æ€§çš„å½±å“ã€‚ICDAR 2015æ•°æ®é›†çš„å›¾åƒæ•°é‡è™½ç„¶ç›¸å¯¹æœ‰é™ï¼Œä½†å…¶æ ‡æ³¨çš„å‡†ç¡®æ€§å’Œåœºæ™¯çš„å¤šæ ·æ€§ä¸ºæ¨¡å‹çš„è®­ç»ƒæä¾›äº†åšå®çš„åŸºç¡€ã€‚é€šè¿‡å¯¹YOLOv8æ¨¡å‹çš„æ”¹è¿›ï¼Œç ”ç©¶è€…å¯ä»¥æ¢ç´¢å¦‚ä½•åœ¨ä¿æŒå®æ—¶æ£€æµ‹é€Ÿåº¦çš„åŒæ—¶ï¼Œæå‡æ–‡æœ¬æ£€æµ‹çš„å‡†ç¡®ç‡ã€‚è¿™ç§æ”¹è¿›å¯èƒ½æ¶‰åŠç½‘ç»œç»“æ„çš„ä¼˜åŒ–ã€æŸå¤±å‡½æ•°çš„è°ƒæ•´ä»¥åŠæ•°æ®å¢å¼ºæŠ€æœ¯çš„åº”ç”¨ç­‰å¤šä¸ªæ–¹é¢ã€‚

æ­¤å¤–ï¼Œéšç€ç¤¾ä¼šå¯¹ä¿¡æ¯æå–æ•ˆç‡çš„è¦æ±‚ä¸æ–­æé«˜ï¼ŒåŸºäºæ”¹è¿›YOLOv8çš„æ–‡æœ¬æ£€æµ‹ç³»ç»Ÿåœ¨å®é™…åº”ç”¨ä¸­çš„æ„ä¹‰æ„ˆå‘å‡¸æ˜¾ã€‚ä¾‹å¦‚ï¼Œåœ¨æ™ºèƒ½äº¤é€šç³»ç»Ÿä¸­ï¼Œå®æ—¶è¯†åˆ«å’Œå¤„ç†äº¤é€šæ ‡è¯†ä¸Šçš„æ–‡æœ¬ä¿¡æ¯å¯¹äºæé«˜äº¤é€šå®‰å…¨å’Œç®¡ç†æ•ˆç‡è‡³å…³é‡è¦ã€‚åœ¨æ–‡æ¡£æ•°å­—åŒ–è¿‡ç¨‹ä¸­ï¼Œå‡†ç¡®æå–æ–‡æœ¬ä¿¡æ¯èƒ½å¤Ÿæ˜¾è‘—æå‡ä¿¡æ¯æ£€ç´¢çš„æ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚å› æ­¤ï¼Œç ”ç©¶åŸºäºæ”¹è¿›YOLOv8çš„æ–‡æœ¬æ£€æµ‹ç³»ç»Ÿï¼Œä¸ä»…èƒ½å¤Ÿæ¨åŠ¨å­¦æœ¯ç•Œåœ¨è®¡ç®—æœºè§†è§‰é¢†åŸŸçš„è¿›æ­¥ï¼Œè¿˜èƒ½ä¸ºå®é™…åº”ç”¨æä¾›å¼ºæœ‰åŠ›çš„æŠ€æœ¯æ”¯æŒã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒåŸºäºæ”¹è¿›YOLOv8çš„æ–‡æœ¬æ£€æµ‹ç³»ç»Ÿçš„ç ”ç©¶ï¼Œä¸ä»…æœ‰åŠ©äºæå‡æ–‡æœ¬æ£€æµ‹çš„æŠ€æœ¯æ°´å¹³ï¼Œè¿˜æœ‰åŠ©äºæ¨åŠ¨ç›¸å…³é¢†åŸŸçš„åº”ç”¨åˆ›æ–°ã€‚é€šè¿‡å……åˆ†åˆ©ç”¨ICDAR 2015æ•°æ®é›†çš„ä¼˜åŠ¿ï¼Œç ”ç©¶è€…å¯ä»¥åœ¨æ–‡æœ¬æ£€æµ‹çš„ç²¾åº¦å’Œæ•ˆç‡ä¸Šå–å¾—æ–°çš„çªç ´ï¼Œä¸ºæœªæ¥çš„ç ”ç©¶å’Œåº”ç”¨å¥ å®šåšå®çš„åŸºç¡€ã€‚

### 2.å›¾ç‰‡æ¼”ç¤º

![1.png](1.png)

![2.png](2.png)

![3.png](3.png)

##### æ³¨æ„ï¼šç”±äºæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ2.å›¾ç‰‡æ¼”ç¤ºâ€å’Œâ€œ3.è§†é¢‘æ¼”ç¤ºâ€å±•ç¤ºçš„ç³»ç»Ÿå›¾ç‰‡æˆ–è€…è§†é¢‘å¯èƒ½ä¸ºè€ç‰ˆæœ¬ï¼Œæ–°ç‰ˆæœ¬åœ¨è€ç‰ˆæœ¬çš„åŸºç¡€ä¸Šå‡çº§å¦‚ä¸‹ï¼šï¼ˆå®é™…æ•ˆæœä»¥å‡çº§çš„æ–°ç‰ˆæœ¬ä¸ºå‡†ï¼‰

  ï¼ˆ1ï¼‰é€‚é…äº†YOLOV8çš„â€œç›®æ ‡æ£€æµ‹â€æ¨¡å‹å’Œâ€œå®ä¾‹åˆ†å‰²â€æ¨¡å‹ï¼Œé€šè¿‡åŠ è½½ç›¸åº”çš„æƒé‡ï¼ˆ.ptï¼‰æ–‡ä»¶å³å¯è‡ªé€‚åº”åŠ è½½æ¨¡å‹ã€‚

  ï¼ˆ2ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®æ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«æ¨¡å¼ã€‚

  ï¼ˆ3ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®æ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«ç»“æœä¿å­˜å¯¼å‡ºï¼Œè§£å†³æ‰‹åŠ¨å¯¼å‡ºï¼ˆå®¹æ˜“å¡é¡¿å‡ºç°çˆ†å†…å­˜ï¼‰å­˜åœ¨çš„é—®é¢˜ï¼Œè¯†åˆ«å®Œè‡ªåŠ¨ä¿å­˜ç»“æœå¹¶å¯¼å‡ºåˆ°tempDirä¸­ã€‚

  ï¼ˆ4ï¼‰æ”¯æŒWebå‰ç«¯ç³»ç»Ÿä¸­çš„æ ‡é¢˜ã€èƒŒæ™¯å›¾ç­‰è‡ªå®šä¹‰ä¿®æ”¹ï¼Œåé¢æä¾›ä¿®æ”¹æ•™ç¨‹ã€‚

  å¦å¤–æœ¬é¡¹ç›®æä¾›è®­ç»ƒçš„æ•°æ®é›†å’Œè®­ç»ƒæ•™ç¨‹,æš‚ä¸æä¾›æƒé‡æ–‡ä»¶ï¼ˆbest.ptï¼‰,éœ€è¦æ‚¨æŒ‰ç…§æ•™ç¨‹è¿›è¡Œè®­ç»ƒåå®ç°å›¾ç‰‡æ¼”ç¤ºå’ŒWebå‰ç«¯ç•Œé¢æ¼”ç¤ºçš„æ•ˆæœã€‚

### 3.è§†é¢‘æ¼”ç¤º

[3.1 è§†é¢‘æ¼”ç¤º](https://www.bilibili.com/video/BV1TWtLeDEqx/)

### 4.æ•°æ®é›†ä¿¡æ¯å±•ç¤º

##### 4.1 æœ¬é¡¹ç›®æ•°æ®é›†è¯¦ç»†æ•°æ®ï¼ˆç±»åˆ«æ•°ï¼†ç±»åˆ«åï¼‰

nc: 1
names: ['text']


##### 4.2 æœ¬é¡¹ç›®æ•°æ®é›†ä¿¡æ¯ä»‹ç»

æ•°æ®é›†ä¿¡æ¯å±•ç¤º

åœ¨ç°ä»£è®¡ç®—æœºè§†è§‰é¢†åŸŸï¼Œæ–‡æœ¬æ£€æµ‹æŠ€æœ¯çš„è¿›æ­¥å¯¹äºå„ç§åº”ç”¨åœºæ™¯è‡³å…³é‡è¦ï¼Œå°¤å…¶æ˜¯åœ¨æ–‡æ¡£åˆ†æã€è‡ªåŠ¨é©¾é©¶ã€æ™ºèƒ½ç›‘æ§ç­‰é¢†åŸŸã€‚ä¸ºäº†æ¨åŠ¨è¿™ä¸€æŠ€æœ¯çš„å‘å±•ï¼Œæœ¬ç ”ç©¶é€‰ç”¨äº†â€œicdar2015 textâ€æ•°æ®é›†ä½œä¸ºè®­ç»ƒæ”¹è¿›YOLOv8æ–‡æœ¬æ£€æµ‹ç³»ç»Ÿçš„åŸºç¡€ã€‚è¯¥æ•°æ®é›†æ˜¯ç”±å›½é™…æ–‡æ¡£åˆ†æä¸è¯†åˆ«ä¼šè®®ï¼ˆICDARï¼‰ç»„ç»‡çš„ï¼Œæ—¨åœ¨ä¸ºæ–‡æœ¬æ£€æµ‹ç®—æ³•æä¾›æ ‡å‡†åŒ–çš„è¯„ä¼°åŸºå‡†ã€‚å…¶ç‹¬ç‰¹ä¹‹å¤„åœ¨äºï¼Œæ•°æ®é›†ä¸“æ³¨äºæ–‡æœ¬çš„æ£€æµ‹ä¸è¯†åˆ«ï¼Œæ¶µç›–äº†å¤šç§å¤æ‚çš„åœºæ™¯å’Œæ–‡æœ¬å¸ƒå±€ï¼Œæå¤§åœ°ä¸°å¯Œäº†ç®—æ³•çš„è®­ç»ƒå’Œæµ‹è¯•ç¯å¢ƒã€‚

â€œicdar2015 textâ€æ•°æ®é›†çš„è®¾è®¡è€ƒè™‘åˆ°äº†æ–‡æœ¬åœ¨ä¸åŒèƒŒæ™¯ä¸‹çš„å¤šæ ·æ€§å’Œå¤æ‚æ€§ï¼ŒåŒ…å«äº†æ¥è‡ªè‡ªç„¶åœºæ™¯çš„å›¾åƒï¼Œæ¶‰åŠè¡—é“æ ‡è¯†ã€å¹¿å‘Šç‰Œã€å•†åº—æ‹›ç‰Œç­‰å¤šç§å®é™…åº”ç”¨åœºæ™¯ã€‚è¿™äº›å›¾åƒä¸ä»…åŒ…å«äº†å„ç§å­—ä½“ã€é¢œè‰²å’Œå¤§å°çš„æ–‡æœ¬ï¼Œè¿˜æ¶µç›–äº†ä¸åŒçš„å…‰ç…§æ¡ä»¶å’Œè§†è§’å˜åŒ–ï¼Œä½¿å¾—æ•°æ®é›†åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­èƒ½å¤Ÿæœ‰æ•ˆæé«˜æ¨¡å‹çš„é²æ£’æ€§å’Œé€‚åº”æ€§ã€‚é€šè¿‡å¯¹è¿™äº›å¤šæ ·åŒ–åœºæ™¯çš„å­¦ä¹ ï¼ŒYOLOv8æ¨¡å‹èƒ½å¤Ÿæ›´å¥½åœ°ç†è§£å’Œè¯†åˆ«å„ç§æ–‡æœ¬ç‰¹å¾ï¼Œä»è€Œæå‡å…¶åœ¨å®é™…åº”ç”¨ä¸­çš„è¡¨ç°ã€‚

åœ¨ç±»åˆ«æ–¹é¢ï¼Œâ€œicdar2015 textâ€æ•°æ®é›†çš„è®¾ç½®ç›¸å¯¹ç®€æ´ï¼Œåªæœ‰ä¸€ä¸ªç±»åˆ«ï¼Œå³â€œtextâ€ã€‚è¿™ä¸€ç±»åˆ«çš„è®¾è®¡æ—¨åœ¨ä¸“æ³¨äºæ–‡æœ¬çš„æ£€æµ‹ä»»åŠ¡ï¼Œé¿å…äº†å¤šç±»åˆ«é—´çš„å¹²æ‰°ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿä¸“æ³¨äºæ–‡æœ¬åŒºåŸŸçš„ç²¾ç¡®å®šä½å’Œè¯†åˆ«ã€‚å°½ç®¡ç±»åˆ«æ•°é‡æœ‰é™ï¼Œä½†æ•°æ®é›†ä¸­çš„æ ·æœ¬æ•°é‡å’Œå¤šæ ·æ€§å¼¥è¡¥äº†è¿™ä¸€ä¸è¶³ï¼Œç¡®ä¿äº†æ¨¡å‹åœ¨å¤„ç†æ–‡æœ¬æ—¶çš„é«˜æ•ˆæ€§å’Œå‡†ç¡®æ€§ã€‚

æ•°æ®é›†çš„æ ‡æ³¨é‡‡ç”¨äº†ç²¾ç¡®çš„è¾¹ç•Œæ¡†ï¼ˆbounding boxï¼‰æ ‡æ³¨æ–¹å¼ï¼Œä¸ºæ¯ä¸ªæ–‡æœ¬åŒºåŸŸæä¾›äº†å‡†ç¡®çš„ä½ç½®ä¿¡æ¯ã€‚è¿™ç§æ ‡æ³¨æ–¹å¼ä¸ä»…ä¾¿äºæ¨¡å‹è¿›è¡Œè®­ç»ƒï¼Œä¹Ÿä¸ºåç»­çš„è¯„ä¼°æä¾›äº†æ¸…æ™°çš„æ ‡å‡†ã€‚é€šè¿‡å¯¹è¿™äº›æ ‡æ³¨æ•°æ®çš„å­¦ä¹ ï¼ŒYOLOv8èƒ½å¤Ÿåœ¨å›¾åƒä¸­å¿«é€Ÿè€Œå‡†ç¡®åœ°å®šä½æ–‡æœ¬åŒºåŸŸï¼Œè¿›è€Œå®ç°é«˜æ•ˆçš„æ–‡æœ¬æ£€æµ‹ã€‚

åœ¨æ•°æ®é›†çš„ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œç ”ç©¶è€…ä»¬å¯ä»¥é€šè¿‡æ•°æ®å¢å¼ºæŠ€æœ¯è¿›ä¸€æ­¥ä¸°å¯Œè®­ç»ƒæ ·æœ¬ï¼Œæå‡æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚å¸¸è§çš„æ•°æ®å¢å¼ºæ–¹æ³•åŒ…æ‹¬éšæœºè£å‰ªã€æ—‹è½¬ã€é¢œè‰²å˜æ¢ç­‰ï¼Œè¿™äº›æ–¹æ³•èƒ½å¤Ÿæœ‰æ•ˆå¢åŠ æ¨¡å‹å¯¹ä¸åŒåœºæ™¯å’Œæ¡ä»¶çš„é€‚åº”æ€§ã€‚æ­¤å¤–ï¼Œç»“åˆè¿ç§»å­¦ä¹ ç­‰å…ˆè¿›æŠ€æœ¯ï¼Œç ”ç©¶è€…å¯ä»¥åœ¨å·²æœ‰çš„YOLOv8æ¨¡å‹åŸºç¡€ä¸Šè¿›è¡Œå¾®è°ƒï¼Œä»è€Œå®ç°æ›´ä¼˜çš„æ–‡æœ¬æ£€æµ‹æ•ˆæœã€‚

æ€»ä¹‹ï¼Œâ€œicdar2015 textâ€æ•°æ®é›†ä¸ºæ”¹è¿›YOLOv8æ–‡æœ¬æ£€æµ‹ç³»ç»Ÿæä¾›äº†ä¸€ä¸ªé«˜è´¨é‡çš„è®­ç»ƒåŸºç¡€ã€‚é€šè¿‡å……åˆ†åˆ©ç”¨è¯¥æ•°æ®é›†çš„å¤šæ ·æ€§å’Œä¸°å¯Œæ€§ï¼Œç ”ç©¶è€…èƒ½å¤Ÿæœ‰æ•ˆæå‡æ¨¡å‹åœ¨å®é™…åº”ç”¨ä¸­çš„è¡¨ç°ï¼Œæ¨åŠ¨æ–‡æœ¬æ£€æµ‹æŠ€æœ¯çš„è¿›ä¸€æ­¥å‘å±•ã€‚è¿™ä¸€æ•°æ®é›†ä¸ä»…æ˜¯æ–‡æœ¬æ£€æµ‹é¢†åŸŸçš„é‡è¦èµ„æºï¼Œä¹Ÿä¸ºåç»­çš„ç ”ç©¶å’Œåº”ç”¨æä¾›äº†åšå®çš„åŸºç¡€ã€‚

![4.png](4.png)

![5.png](5.png)

![6.png](6.png)

![7.png](7.png)

![8.png](8.png)

### 5.å…¨å¥—é¡¹ç›®ç¯å¢ƒéƒ¨ç½²è§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰

[5.1 ç¯å¢ƒéƒ¨ç½²æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404473917358506534?logTag=c807d0cbc21c0ef59de5)




[5.2 å®‰è£…Pythonè™šæ‹Ÿç¯å¢ƒåˆ›å»ºå’Œä¾èµ–åº“å®‰è£…è§†é¢‘æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404474678003106304?logTag=1f1041108cd1f708b01a)

### 6.æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰

[6.1 æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰](https://www.ixigua.com/7404477157818401292?logTag=d31a2dfd1983c9668658)

### 7.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡å‹çš„é…ç½®æ–‡ä»¶ï¼‰

[7.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡å‹çš„é…ç½®æ–‡ä»¶ï¼‰](https://www.ixigua.com/7404478314661806627?logTag=29066f8288e3f4eea3a4)

### 8.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŸç†è®²è§£ï¼ˆéç§‘ç­ä¹Ÿå¯ä»¥è½»æ¾å†™åˆŠå‘åˆŠï¼ŒV10ç‰ˆæœ¬æ­£åœ¨ç§‘ç ”å¾…æ›´æ–°ï¼‰

ç”±äºç¯‡å¹…é™åˆ¶ï¼Œæ¯ä¸ªåˆ›æ–°ç‚¹çš„å…·ä½“åŸç†è®²è§£å°±ä¸ä¸€ä¸€å±•å¼€ï¼Œå…·ä½“è§ä¸‹åˆ—ç½‘å€ä¸­çš„åˆ›æ–°ç‚¹å¯¹åº”å­é¡¹ç›®çš„æŠ€æœ¯åŸç†åšå®¢ç½‘å€ã€Blogã€‘ï¼š

![9.png](9.png)

[8.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŸç†è®²è§£é“¾æ¥](https://gitee.com/qunmasj/good)

### 9.ç³»ç»ŸåŠŸèƒ½å±•ç¤ºï¼ˆæ£€æµ‹å¯¹è±¡ä¸ºä¸¾ä¾‹ï¼Œå®é™…å†…å®¹ä»¥æœ¬é¡¹ç›®æ•°æ®é›†ä¸ºå‡†ï¼‰

å›¾9.1.ç³»ç»Ÿæ”¯æŒæ£€æµ‹ç»“æœè¡¨æ ¼æ˜¾ç¤º

  å›¾9.2.ç³»ç»Ÿæ”¯æŒç½®ä¿¡åº¦å’ŒIOUé˜ˆå€¼æ‰‹åŠ¨è°ƒèŠ‚

  å›¾9.3.ç³»ç»Ÿæ”¯æŒè‡ªå®šä¹‰åŠ è½½æƒé‡æ–‡ä»¶best.pt(éœ€è¦ä½ é€šè¿‡æ­¥éª¤5ä¸­è®­ç»ƒè·å¾—)

  å›¾9.4.ç³»ç»Ÿæ”¯æŒæ‘„åƒå¤´å®æ—¶è¯†åˆ«

  å›¾9.5.ç³»ç»Ÿæ”¯æŒå›¾ç‰‡è¯†åˆ«

  å›¾9.6.ç³»ç»Ÿæ”¯æŒè§†é¢‘è¯†åˆ«

  å›¾9.7.ç³»ç»Ÿæ”¯æŒè¯†åˆ«ç»“æœæ–‡ä»¶è‡ªåŠ¨ä¿å­˜

  å›¾9.8.ç³»ç»Ÿæ”¯æŒExcelå¯¼å‡ºæ£€æµ‹ç»“æœæ•°æ®

![10.png](10.png)

![11.png](11.png)

![12.png](12.png)

![13.png](13.png)

![14.png](14.png)

![15.png](15.png)

![16.png](16.png)

![17.png](17.png)

### 10.åŸå§‹YOLOV8ç®—æ³•åŸç†

åŸå§‹YOLOv8ç®—æ³•åŸç†

YOLOï¼ˆYou Only Look Onceï¼‰ç³»åˆ—ç®—æ³•è‡ªå…¶é¦–æ¬¡æå‡ºä»¥æ¥ï¼Œä¾¿ä»¥å…¶é«˜æ•ˆçš„ç›®æ ‡æ£€æµ‹èƒ½åŠ›è€Œå—åˆ°å¹¿æ³›å…³æ³¨ã€‚YOLOv8ä½œä¸ºè¯¥ç³»åˆ—çš„æœ€æ–°ç‰ˆæœ¬ï¼Œæ‰¿è½½äº†å‰å‡ ä»£ç®—æ³•çš„ä¼˜ç‚¹ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œäº†å¤šé¡¹åˆ›æ–°å’Œæ”¹è¿›ï¼Œæ—¨åœ¨æå‡ç›®æ ‡æ£€æµ‹çš„ç²¾åº¦å’Œé€Ÿåº¦ã€‚YOLOv8çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†ç›®æ ‡æ£€æµ‹ä»»åŠ¡è½¬åŒ–ä¸ºä¸€ä¸ªå›å½’é—®é¢˜ï¼Œé€šè¿‡ä¸€ä¸ªå•ä¸€çš„ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œå®æ—¶é¢„æµ‹ç›®æ ‡çš„ä½ç½®å’Œç±»åˆ«ï¼Œä»è€Œå®ç°é«˜æ•ˆçš„ç›®æ ‡æ£€æµ‹ã€‚

YOLOv8çš„ç½‘ç»œç»“æ„ç”±ä¸‰ä¸ªä¸»è¦éƒ¨åˆ†ç»„æˆï¼šä¸»å¹²ç½‘ç»œï¼ˆbackboneï¼‰ã€ç‰¹å¾å¢å¼ºç½‘ç»œï¼ˆneckï¼‰å’Œæ£€æµ‹å¤´ï¼ˆheadï¼‰ã€‚åœ¨ä¸»å¹²ç½‘ç»œéƒ¨åˆ†ï¼ŒYOLOv8ç»§ç»­é‡‡ç”¨CSPï¼ˆCross Stage Partialï¼‰ç»“æ„ï¼Œè¿™ç§è®¾è®¡ç†å¿µä½¿å¾—ç½‘ç»œèƒ½å¤Ÿæœ‰æ•ˆåœ°æå–ç‰¹å¾ï¼ŒåŒæ—¶å‡å°‘è®¡ç®—é‡ã€‚ä¸ä¹‹å‰çš„YOLOç‰ˆæœ¬ç›¸æ¯”ï¼ŒYOLOv8åœ¨ä¸»å¹²ç½‘ç»œä¸­å¼•å…¥äº†C2Fæ¨¡å—ï¼Œè¿™ä¸€æ¨¡å—é€šè¿‡å¹¶è¡Œå¤šä¸ªæ¢¯åº¦æµåˆ†æ”¯ï¼Œå¢å¼ºäº†ç‰¹å¾æå–çš„èƒ½åŠ›ï¼Œä»è€Œæé«˜äº†æ¨¡å‹çš„æ•´ä½“æ€§èƒ½ã€‚C2Fæ¨¡å—çš„è®¾è®¡ä¸ä»…ä¿è¯äº†ç½‘ç»œçš„è½»é‡åŒ–ï¼Œè¿˜æœ‰æ•ˆæå‡äº†ç²¾åº¦å’Œå»¶è¿Ÿè¡¨ç°ï¼Œä½¿å¾—YOLOv8åœ¨å¤„ç†å¤æ‚åœºæ™¯æ—¶èƒ½å¤Ÿæ›´ä¸ºæ¸¸åˆƒæœ‰ä½™ã€‚

åœ¨ç‰¹å¾å¢å¼ºç½‘ç»œéƒ¨åˆ†ï¼ŒYOLOv8é‡‡ç”¨äº†PAN-FPNï¼ˆPath Aggregation Network - Feature Pyramid Networkï¼‰çš„æ€æƒ³ã€‚è¿™ä¸€ç»“æ„é€šè¿‡ä¸åŒå±‚æ¬¡ç‰¹å¾çš„èåˆï¼Œè¿›ä¸€æ­¥å¢å¼ºäº†æ¨¡å‹å¯¹å¤šå°ºåº¦ç›®æ ‡çš„æ£€æµ‹èƒ½åŠ›ã€‚PAN-FPNçš„è®¾è®¡ä½¿å¾—ç‰¹å¾ä¿¡æ¯èƒ½å¤Ÿåœ¨ä¸åŒå±‚æ¬¡ä¹‹é—´æœ‰æ•ˆä¼ é€’ï¼Œä»è€Œæå‡äº†å¯¹å°ç›®æ ‡å’Œå¤§ç›®æ ‡çš„æ£€æµ‹ç²¾åº¦ã€‚æ­¤å¤–ï¼ŒYOLOv8åœ¨Neckéƒ¨åˆ†çš„æ”¹è¿›è¿˜ä½“ç°åœ¨å»é™¤äº†å¤šä½™çš„å·ç§¯è¿æ¥å±‚ï¼Œç›´æ¥å¯¹ä¸åŒé˜¶æ®µè¾“å‡ºçš„ç‰¹å¾è¿›è¡Œä¸Šé‡‡æ ·æ“ä½œï¼Œè¿™ä¸€ç®€åŒ–è®¾è®¡æœ‰æ•ˆå‡å°‘äº†è®¡ç®—å¤æ‚åº¦ã€‚

YOLOv8çš„æ£€æµ‹å¤´éƒ¨åˆ†æ˜¯å…¶åˆ›æ–°çš„å…³é”®æ‰€åœ¨ã€‚ä¸ä»¥å¾€çš„è€¦åˆå¤´ï¼ˆCoupled-Headï¼‰ä¸åŒï¼ŒYOLOv8é‡‡ç”¨äº†è§£è€¦å¤´ï¼ˆDecoupled-Headï¼‰ç»“æ„ï¼Œå°†ç›®æ ‡çš„åˆ†ç±»å’Œå›å½’ä»»åŠ¡åˆ†ä¸ºä¸¤ä¸ªç‹¬ç«‹çš„åˆ†æ”¯ã€‚è¿™ä¸€è®¾è®¡ä½¿å¾—æ¯ä¸ªä»»åŠ¡èƒ½å¤Ÿæ›´åŠ ä¸“æ³¨äºè‡ªèº«çš„ç›®æ ‡ï¼Œä»è€Œæœ‰æ•ˆå‡å°‘äº†åœ¨å¤æ‚åœºæ™¯ä¸‹å¯èƒ½å‡ºç°çš„å®šä½ä¸å‡†å’Œåˆ†ç±»é”™è¯¯çš„é—®é¢˜ã€‚è§£è€¦å¤´çš„å¼•å…¥ä¸ä»…æå‡äº†æ¨¡å‹çš„å¯è§£é‡Šæ€§ï¼Œä¹Ÿä¸ºåç»­çš„ä¼˜åŒ–æä¾›äº†æ›´å¤§çš„çµæ´»æ€§ã€‚

åœ¨æŸå¤±å‡½æ•°çš„è®¾è®¡ä¸Šï¼ŒYOLOv8åŒæ ·è¿›è¡Œäº†é‡è¦çš„æ”¹è¿›ã€‚ä¸ºäº†æé«˜æ¨¡å‹åœ¨è®­ç»ƒå’Œæ¨ç†è¿‡ç¨‹ä¸­çš„ä¸€è‡´æ€§ï¼ŒYOLOv8å–æ¶ˆäº†Objåˆ†æ”¯ï¼Œåˆ†ç±»åˆ†æ”¯ä¾ç„¶é‡‡ç”¨äºŒå€¼äº¤å‰ç†µæŸå¤±ï¼ˆBCELossï¼‰ï¼Œè€Œè¾¹ç•Œæ¡†å›å½’åˆ†æ”¯åˆ™ä½¿ç”¨äº†åˆ†å¸ƒç„¦ç‚¹æŸå¤±ï¼ˆDFLï¼‰å’Œå®Œç¾äº¤å¹¶æ¯”æŸå¤±ï¼ˆCIoULossï¼‰ã€‚è¿™ç§æ–°çš„æŸå¤±ç­–ç•¥ä½¿å¾—ç½‘ç»œèƒ½å¤Ÿæ›´å¿«åœ°èšç„¦äºæ ‡ç­¾é™„è¿‘çš„æ•°å€¼ï¼Œä»è€Œæå‡äº†æ£€æµ‹ç²¾åº¦ã€‚

YOLOv8è¿˜å¼•å…¥äº†Anchor-freeç›®æ ‡æ£€æµ‹æ–¹æ³•ï¼Œè¿™ä¸€æ–¹æ³•ä¸ä¼ ç»Ÿçš„Anchor-basedæ–¹æ³•æˆªç„¶ä¸åŒã€‚ä¼ ç»Ÿæ–¹æ³•ä¾èµ–äºé¢„å…ˆå®šä¹‰çš„é”šæ¡†æ¥é¢„æµ‹ç›®æ ‡ä½ç½®ï¼Œè¿™ç§æ–¹å¼åœ¨å¤„ç†ä¸åŒå°ºåº¦å’Œå½¢çŠ¶çš„ç›®æ ‡æ—¶å¾€å¾€æ˜¾å¾—ä¸å¤Ÿçµæ´»ã€‚è€ŒYOLOv8é€šè¿‡å°†ç›®æ ‡æ£€æµ‹è½¬åŒ–ä¸ºå…³é”®ç‚¹æ£€æµ‹ï¼Œç›´æ¥é¢„æµ‹ç›®æ ‡çš„ä½ç½®å’Œå¤§å°ï¼Œé¿å…äº†é”šæ¡†é€‰æ‹©å’Œè°ƒæ•´çš„ç¹çè¿‡ç¨‹ã€‚è¿™ä¸€åˆ›æ–°ä¸ä»…æå‡äº†æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ï¼Œä¹Ÿä½¿å¾—ç½‘ç»œæ¡†æ¶æ›´åŠ ç®€æ´ï¼Œè®¡ç®—æ•ˆç‡æ˜¾è‘—æé«˜ã€‚

åœ¨è¾“å…¥å¤„ç†æ–¹é¢ï¼ŒYOLOv8åŒæ ·å±•ç°äº†å…¶çµæ´»æ€§ã€‚é»˜è®¤è¾“å…¥å›¾åƒå°ºå¯¸ä¸º640x640ï¼Œä½†åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒYOLOv8é‡‡ç”¨è‡ªé€‚åº”å›¾ç‰‡ç¼©æ”¾æŠ€æœ¯ï¼Œä»¥æé«˜ç›®æ ‡æ£€æµ‹å’Œæ¨ç†çš„é€Ÿåº¦ã€‚è¿™ä¸€æ–¹æ³•é€šè¿‡å°†é•¿è¾¹æŒ‰æ¯”ä¾‹ç¼©å°è‡³æŒ‡å®šå°ºå¯¸ï¼Œå¹¶å¯¹çŸ­è¾¹è¿›è¡Œå¡«å……ï¼Œå°½é‡å‡å°‘ä¿¡æ¯å†—ä½™ï¼Œç¡®ä¿äº†ç›®æ ‡æ£€æµ‹çš„é«˜æ•ˆæ€§ã€‚æ­¤å¤–ï¼ŒYOLOv8åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¼•å…¥äº†Mosaicå›¾åƒå¢å¼ºæ“ä½œï¼Œé€šè¿‡éšæœºæ‹¼æ¥å¤šå¼ å›¾åƒï¼Œè¿«ä½¿æ¨¡å‹å­¦ä¹ ä¸åŒä½ç½®å’Œå‘¨å›´åƒç´ çš„ç‰¹å¾ï¼Œä»è€Œè¿›ä¸€æ­¥æå‡äº†æ¨¡å‹çš„é²æ£’æ€§å’Œå‡†ç¡®æ€§ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒYOLOv8åœ¨å¤šä¸ªæ–¹é¢è¿›è¡Œäº†åˆ›æ–°å’Œä¼˜åŒ–ï¼Œä½¿å…¶åœ¨ç›®æ ‡æ£€æµ‹é¢†åŸŸä¸­å±•ç°å‡ºæ›´å¼ºçš„æ€§èƒ½å’Œçµæ´»æ€§ã€‚é€šè¿‡å¼•å…¥è§£è€¦å¤´ã€Anchor-freeæ–¹æ³•ä»¥åŠæ”¹è¿›çš„æŸå¤±å‡½æ•°ï¼ŒYOLOv8ä¸ä»…æå‡äº†æ£€æµ‹ç²¾åº¦ï¼Œä¹Ÿé™ä½äº†è®¡ç®—å¤æ‚åº¦ï¼Œä½¿å…¶èƒ½å¤Ÿåœ¨å®æ—¶æ£€æµ‹ä»»åŠ¡ä¸­è¡¨ç°å‡ºè‰²ã€‚è¿™äº›æ”¹è¿›ä½¿å¾—YOLOv8æˆä¸ºäº†å½“å‰æœ€å…ˆè¿›çš„ç›®æ ‡æ£€æµ‹ç®—æ³•ä¹‹ä¸€ï¼Œé€‚ç”¨äºå„ç§åº”ç”¨åœºæ™¯ï¼ŒåŒ…æ‹¬å›¾åƒåˆ†å‰²å’Œå›¾åƒåˆ†ç±»ç­‰ä»»åŠ¡ã€‚éšç€YOLOv8çš„ä¸æ–­å‘å±•å’Œå®Œå–„ï¼Œå…¶åœ¨å®é™…åº”ç”¨ä¸­çš„æ½œåŠ›å°†ä¼šè¿›ä¸€æ­¥å¾—åˆ°æŒ–æ˜ï¼Œä¸ºç›®æ ‡æ£€æµ‹æŠ€æœ¯çš„è¿›æ­¥åšå‡ºæ›´å¤§çš„è´¡çŒ®ã€‚

![18.png](18.png)

### 11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰

#### 11.1 code\ultralytics\utils\callbacks\hub.py

ä»¥ä¸‹æ˜¯å¯¹ä»£ç çš„æ ¸å¿ƒéƒ¨åˆ†è¿›è¡Œçš„æç‚¼å’Œè¯¦ç»†æ³¨é‡Šï¼š

```python
# Ultralytics YOLO ğŸš€, AGPL-3.0 license

import json
from time import time
from ultralytics.hub.utils import HUB_WEB_ROOT, PREFIX, events
from ultralytics.utils import LOGGER, SETTINGS

def on_fit_epoch_end(trainer):
    """åœ¨æ¯ä¸ªè®­ç»ƒå‘¨æœŸç»“æŸæ—¶ä¸Šä¼ è®­ç»ƒè¿›åº¦æŒ‡æ ‡ã€‚"""
    session = getattr(trainer, "hub_session", None)  # è·å–è®­ç»ƒå™¨çš„ä¼šè¯å¯¹è±¡
    if session:
        # æ”¶é›†è®­ç»ƒæŸå¤±å’ŒæŒ‡æ ‡
        all_plots = {
            **trainer.label_loss_items(trainer.tloss, prefix="train"),  # è·å–è®­ç»ƒæŸå¤±
            **trainer.metrics,  # è·å–è®­ç»ƒæŒ‡æ ‡
        }
        if trainer.epoch == 0:
            from ultralytics.utils.torch_utils import model_info_for_loggers
            # åœ¨ç¬¬ä¸€ä¸ªå‘¨æœŸæ—¶ï¼Œæ·»åŠ æ¨¡å‹ä¿¡æ¯
            all_plots = {**all_plots, **model_info_for_loggers(trainer)}

        # å°†å½“å‰å‘¨æœŸçš„æŒ‡æ ‡åºåˆ—åŒ–ä¸ºJSONæ ¼å¼å¹¶å­˜å…¥é˜Ÿåˆ—
        session.metrics_queue[trainer.epoch] = json.dumps(all_plots)
        
        # æ£€æŸ¥æ˜¯å¦è¶…è¿‡ä¸Šä¼ é€Ÿç‡é™åˆ¶
        if time() - session.timers["metrics"] > session.rate_limits["metrics"]:
            session.upload_metrics()  # ä¸Šä¼ æŒ‡æ ‡
            session.timers["metrics"] = time()  # é‡ç½®è®¡æ—¶å™¨
            session.metrics_queue = {}  # é‡ç½®é˜Ÿåˆ—

def on_model_save(trainer):
    """ä¿å­˜æ£€æŸ¥ç‚¹åˆ°Ultralytics HUBï¼Œå¹¶è¿›è¡Œé€Ÿç‡é™åˆ¶ã€‚"""
    session = getattr(trainer, "hub_session", None)  # è·å–è®­ç»ƒå™¨çš„ä¼šè¯å¯¹è±¡
    if session:
        is_best = trainer.best_fitness == trainer.fitness  # åˆ¤æ–­å½“å‰æ¨¡å‹æ˜¯å¦æ˜¯æœ€ä½³æ¨¡å‹
        # æ£€æŸ¥æ˜¯å¦è¶…è¿‡ä¸Šä¼ é€Ÿç‡é™åˆ¶
        if time() - session.timers["ckpt"] > session.rate_limits["ckpt"]:
            LOGGER.info(f"{PREFIX}Uploading checkpoint {HUB_WEB_ROOT}/models/{session.model_file}")
            session.upload_model(trainer.epoch, trainer.last, is_best)  # ä¸Šä¼ æ¨¡å‹
            session.timers["ckpt"] = time()  # é‡ç½®è®¡æ—¶å™¨

def on_train_end(trainer):
    """åœ¨è®­ç»ƒç»“æŸæ—¶ä¸Šä¼ æœ€ç»ˆæ¨¡å‹å’ŒæŒ‡æ ‡åˆ°Ultralytics HUBã€‚"""
    session = getattr(trainer, "hub_session", None)  # è·å–è®­ç»ƒå™¨çš„ä¼šè¯å¯¹è±¡
    if session:
        LOGGER.info(f"{PREFIX}Syncing final model...")
        # ä¸Šä¼ æœ€ç»ˆæ¨¡å‹å’ŒæŒ‡æ ‡
        session.upload_model(
            trainer.epoch,
            trainer.best,
            map=trainer.metrics.get("metrics/mAP50-95(B)", 0),
            final=True,
        )
        session.alive = False  # åœæ­¢å¿ƒè·³
        LOGGER.info(f"{PREFIX}Done âœ…\n" f"{PREFIX}View model at {session.model_url} ğŸš€")

# å›è°ƒå‡½æ•°é›†åˆï¼Œæ ¹æ®è®¾ç½®å†³å®šæ˜¯å¦å¯ç”¨
callbacks = (
    {
        "on_fit_epoch_end": on_fit_epoch_end,  # è®­ç»ƒå‘¨æœŸç»“æŸæ—¶çš„å›è°ƒ
        "on_model_save": on_model_save,  # æ¨¡å‹ä¿å­˜æ—¶çš„å›è°ƒ
        "on_train_end": on_train_end,  # è®­ç»ƒç»“æŸæ—¶çš„å›è°ƒ
    }
    if SETTINGS["hub"] is True
    else {}
)  # éªŒè¯æ˜¯å¦å¯ç”¨
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†åˆ†æï¼š
1. **`on_fit_epoch_end`**: è¯¥å‡½æ•°åœ¨æ¯ä¸ªè®­ç»ƒå‘¨æœŸç»“æŸæ—¶è¢«è°ƒç”¨ï¼Œè´Ÿè´£æ”¶é›†è®­ç»ƒæŸå¤±å’ŒæŒ‡æ ‡ï¼Œå¹¶å°†å…¶ä¸Šä¼ åˆ°Ultralytics HUBã€‚å®ƒè¿˜å¤„ç†äº†ä¸Šä¼ é€Ÿç‡é™åˆ¶ï¼Œä»¥é¿å…è¿‡äºé¢‘ç¹çš„ä¸Šä¼ ã€‚

2. **`on_model_save`**: è¯¥å‡½æ•°è´Ÿè´£åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¿å­˜æ¨¡å‹æ£€æŸ¥ç‚¹ï¼Œå¹¶ç¡®ä¿ä¸Šä¼ ä¸è¶…è¿‡é€Ÿç‡é™åˆ¶ã€‚å®ƒä¼šåˆ¤æ–­å½“å‰æ¨¡å‹æ˜¯å¦æ˜¯æœ€ä½³æ¨¡å‹ï¼Œå¹¶åœ¨åˆé€‚çš„æ—¶æœºä¸Šä¼ ã€‚

3. **`on_train_end`**: è¯¥å‡½æ•°åœ¨è®­ç»ƒç»“æŸæ—¶è¢«è°ƒç”¨ï¼Œè´Ÿè´£ä¸Šä¼ æœ€ç»ˆçš„æ¨¡å‹å’Œè®­ç»ƒæŒ‡æ ‡ã€‚å®ƒä¼šè®°å½•è®­ç»ƒå®Œæˆçš„ä¿¡æ¯ï¼Œå¹¶åœæ­¢ä¸Ultralytics HUBçš„å¿ƒè·³ã€‚

4. **`callbacks`**: è¿™æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°çš„é›†åˆï¼Œå†³å®šäº†åœ¨ä¸åŒè®­ç»ƒé˜¶æ®µéœ€è¦æ‰§è¡Œçš„æ“ä½œã€‚æ ¹æ®è®¾ç½®å†³å®šæ˜¯å¦å¯ç”¨è¿™äº›å›è°ƒã€‚

ä»¥ä¸Šä»£ç çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯ç¡®ä¿è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ•°æ®èƒ½å¤Ÿæœ‰æ•ˆåœ°ä¸Šä¼ åˆ°Ultralytics HUBï¼ŒåŒæ—¶ç®¡ç†ä¸Šä¼ çš„é¢‘ç‡å’Œæ¨¡å‹çš„ä¿å­˜ã€‚

è¿™ä¸ªæ–‡ä»¶æ˜¯Ultralytics YOLOé¡¹ç›®ä¸­çš„ä¸€ä¸ªå›è°ƒå‡½æ•°æ¨¡å—ï¼Œä¸»è¦ç”¨äºåœ¨è®­ç»ƒã€éªŒè¯å’Œå¯¼å‡ºæ¨¡å‹çš„ä¸åŒé˜¶æ®µä¸Ultralytics HUBè¿›è¡Œäº¤äº’ã€‚ä»£ç ä¸­å®šä¹‰äº†ä¸€ç³»åˆ—çš„å›è°ƒå‡½æ•°ï¼Œè¿™äº›å‡½æ•°åœ¨ç‰¹å®šäº‹ä»¶å‘ç”Ÿæ—¶è¢«è°ƒç”¨ï¼Œä»¥ä¾¿è®°å½•è®­ç»ƒè¿›åº¦ã€ä¸Šä¼ æ¨¡å‹å’ŒæŒ‡æ ‡ç­‰ã€‚

é¦–å…ˆï¼Œæ–‡ä»¶å¯¼å…¥äº†ä¸€äº›å¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬`json`å’Œ`time`ï¼Œä»¥åŠUltralyticsé¡¹ç›®ä¸­çš„ä¸€äº›å·¥å…·å’Œè®¾ç½®ã€‚æ¥ä¸‹æ¥ï¼Œå®šä¹‰äº†ä¸€äº›å›è°ƒå‡½æ•°ï¼š

- `on_pretrain_routine_end(trainer)`ï¼šè¿™ä¸ªå‡½æ•°åœ¨é¢„è®­ç»ƒä¾‹ç¨‹ç»“æŸæ—¶è¢«è°ƒç”¨ï¼Œä¸»è¦ç”¨äºåˆå§‹åŒ–ä¸Šä¼ é€Ÿç‡é™åˆ¶çš„è®¡æ—¶å™¨ã€‚å®ƒæ£€æŸ¥è®­ç»ƒå™¨æ˜¯å¦æœ‰ä¸HUBçš„ä¼šè¯ï¼Œå¦‚æœæœ‰ï¼Œåˆ™å¼€å§‹è®°å½•æ—¶é—´ã€‚

- `on_fit_epoch_end(trainer)`ï¼šåœ¨æ¯ä¸ªè®­ç»ƒå‘¨æœŸç»“æŸæ—¶è°ƒç”¨ï¼Œè´Ÿè´£ä¸Šä¼ è®­ç»ƒè¿›åº¦çš„æŒ‡æ ‡ã€‚å®ƒä¼šå°†å½“å‰çš„æŸå¤±å’Œå…¶ä»–æŒ‡æ ‡æ‰“åŒ…æˆä¸€ä¸ªå­—å…¸ï¼Œå¹¶åœ¨é€‚å½“çš„æ—¶é—´é—´éš”å†…ä¸Šä¼ è¿™äº›æŒ‡æ ‡åˆ°HUBã€‚

- `on_model_save(trainer)`ï¼šè¿™ä¸ªå‡½æ•°åœ¨æ¨¡å‹ä¿å­˜æ—¶è¢«è°ƒç”¨ï¼Œè´Ÿè´£å°†æ¨¡å‹æ£€æŸ¥ç‚¹ä¸Šä¼ åˆ°HUBã€‚å®ƒä¼šæ£€æŸ¥å½“å‰çš„è®­ç»ƒæ•ˆæœæ˜¯å¦æ˜¯æœ€ä½³çš„ï¼Œå¹¶åœ¨æ»¡è¶³é€Ÿç‡é™åˆ¶çš„æƒ…å†µä¸‹è¿›è¡Œä¸Šä¼ ã€‚

- `on_train_end(trainer)`ï¼šè®­ç»ƒç»“æŸæ—¶è°ƒç”¨ï¼Œè´Ÿè´£ä¸Šä¼ æœ€ç»ˆçš„æ¨¡å‹å’ŒæŒ‡æ ‡åˆ°HUBã€‚å®ƒä¼šè®°å½•è®­ç»ƒçš„æœ€ä½³ç»“æœï¼Œå¹¶åœ¨ä¸Šä¼ ååœæ­¢å¿ƒè·³ä¿¡å·ã€‚

- `on_train_start(trainer)`ã€`on_val_start(validator)`ã€`on_predict_start(predictor)`å’Œ`on_export_start(exporter)`ï¼šè¿™äº›å‡½æ•°åœ¨è®­ç»ƒã€éªŒè¯ã€é¢„æµ‹å’Œå¯¼å‡ºå¼€å§‹æ—¶è¢«è°ƒç”¨ï¼Œä¸»è¦ç”¨äºæ‰§è¡Œä¸è¿™äº›äº‹ä»¶ç›¸å…³çš„æ“ä½œã€‚

æœ€åï¼Œä»£ç ä¸­å®šä¹‰äº†ä¸€ä¸ª`callbacks`å­—å…¸ï¼ŒåŒ…å«äº†ä¸Šè¿°æ‰€æœ‰å›è°ƒå‡½æ•°ã€‚å¦‚æœè®¾ç½®ä¸­å¯ç”¨äº†HUBåŠŸèƒ½ï¼Œåˆ™è¿™äº›å›è°ƒå‡½æ•°ä¼šè¢«æ³¨å†Œï¼Œä»¥ä¾¿åœ¨ç›¸åº”çš„äº‹ä»¶å‘ç”Ÿæ—¶è°ƒç”¨ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¿™ä¸ªæ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½æ˜¯å®ç°ä¸Ultralytics HUBçš„äº¤äº’ï¼Œç¡®ä¿åœ¨è®­ç»ƒå’Œæ¨¡å‹ç®¡ç†è¿‡ç¨‹ä¸­èƒ½å¤Ÿæœ‰æ•ˆåœ°ä¸Šä¼ å’Œè®°å½•é‡è¦çš„è®­ç»ƒä¿¡æ¯å’Œæ¨¡å‹çŠ¶æ€ã€‚

#### 11.2 ui.py

```python
import sys
import subprocess

def run_script(script_path):
    """
    ä½¿ç”¨å½“å‰ Python ç¯å¢ƒè¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚

    Args:
        script_path (str): è¦è¿è¡Œçš„è„šæœ¬è·¯å¾„

    Returns:
        None
    """
    # è·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„
    python_path = sys.executable

    # æ„å»ºè¿è¡Œå‘½ä»¤ï¼Œä½¿ç”¨ streamlit è¿è¡ŒæŒ‡å®šçš„è„šæœ¬
    command = f'"{python_path}" -m streamlit run "{script_path}"'

    # æ‰§è¡Œå‘½ä»¤
    result = subprocess.run(command, shell=True)
    # æ£€æŸ¥å‘½ä»¤æ‰§è¡Œçš„è¿”å›ç ï¼Œè‹¥ä¸ä¸º0åˆ™è¡¨ç¤ºå‡ºé”™
    if result.returncode != 0:
        print("è„šæœ¬è¿è¡Œå‡ºé”™ã€‚")

# ä¸»ç¨‹åºå…¥å£
if __name__ == "__main__":
    # æŒ‡å®šè¦è¿è¡Œçš„è„šæœ¬è·¯å¾„
    script_path = "web.py"  # è¿™é‡Œå¯ä»¥ç›´æ¥æŒ‡å®šè„šæœ¬è·¯å¾„

    # è°ƒç”¨å‡½æ•°è¿è¡Œè„šæœ¬
    run_script(script_path)
```

### ä»£ç æ³¨é‡Šè¯´æ˜ï¼š
1. **å¯¼å…¥æ¨¡å—**ï¼š
   - `sys`ï¼šç”¨äºè·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ã€‚
   - `subprocess`ï¼šç”¨äºæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚

2. **`run_script` å‡½æ•°**ï¼š
   - è¯¥å‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•° `script_path`ï¼Œè¡¨ç¤ºè¦è¿è¡Œçš„ Python è„šæœ¬çš„è·¯å¾„ã€‚
   - ä½¿ç”¨ `sys.executable` è·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ã€‚
   - æ„å»ºä¸€ä¸ªå‘½ä»¤å­—ç¬¦ä¸²ï¼Œç”¨äºé€šè¿‡ `streamlit` è¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚
   - ä½¿ç”¨ `subprocess.run` æ‰§è¡Œæ„å»ºçš„å‘½ä»¤ï¼Œå¹¶æ£€æŸ¥è¿”å›ç ä»¥åˆ¤æ–­è„šæœ¬æ˜¯å¦æˆåŠŸè¿è¡Œã€‚

3. **ä¸»ç¨‹åºå…¥å£**ï¼š
   - åœ¨ `if __name__ == "__main__":` è¯­å¥ä¸­ï¼ŒæŒ‡å®šè¦è¿è¡Œçš„è„šæœ¬è·¯å¾„ï¼ˆæ­¤å¤„ä¸º `web.py`ï¼‰ã€‚
   - è°ƒç”¨ `run_script` å‡½æ•°æ¥æ‰§è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½æ˜¯é€šè¿‡å½“å‰çš„ Python ç¯å¢ƒæ¥è¿è¡Œä¸€ä¸ªæŒ‡å®šçš„è„šæœ¬ï¼Œå…·ä½“æ¥è¯´æ˜¯ä¸€ä¸ªåä¸º `web.py` çš„è„šæœ¬ã€‚é¦–å…ˆï¼Œç¨‹åºå¯¼å…¥äº†å¿…è¦çš„æ¨¡å—ï¼ŒåŒ…æ‹¬ `sys`ã€`os` å’Œ `subprocess`ï¼Œè¿™äº›æ¨¡å—åˆ†åˆ«ç”¨äºç³»ç»Ÿç›¸å…³çš„æ“ä½œã€æ–‡ä»¶è·¯å¾„å¤„ç†å’Œæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚

åœ¨ç¨‹åºä¸­å®šä¹‰äº†ä¸€ä¸ªåä¸º `run_script` çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•° `script_path`ï¼Œè¡¨ç¤ºè¦è¿è¡Œçš„è„šæœ¬çš„è·¯å¾„ã€‚å‡½æ•°å†…éƒ¨é¦–å…ˆè·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ï¼Œä½¿ç”¨ `sys.executable` æ¥å®ç°ã€‚æ¥ç€ï¼Œæ„å»ºä¸€ä¸ªå‘½ä»¤å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªå‘½ä»¤å°†ä½¿ç”¨ `streamlit` æ¥è¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚å…·ä½“çš„å‘½ä»¤æ ¼å¼æ˜¯å°† Python è§£é‡Šå™¨çš„è·¯å¾„å’Œè¦è¿è¡Œçš„è„šæœ¬è·¯å¾„ç»“åˆåœ¨ä¸€èµ·ï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´çš„å‘½ä»¤ã€‚

ç„¶åï¼Œä½¿ç”¨ `subprocess.run` æ–¹æ³•æ¥æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼Œ`shell=True` å‚æ•°å…è®¸åœ¨ shell ä¸­æ‰§è¡Œå‘½ä»¤ã€‚æ‰§è¡Œåï¼Œç¨‹åºä¼šæ£€æŸ¥å‘½ä»¤çš„è¿”å›ç ï¼Œå¦‚æœè¿”å›ç ä¸ä¸ºé›¶ï¼Œè¡¨ç¤ºè„šæœ¬è¿è¡Œè¿‡ç¨‹ä¸­å‡ºç°äº†é”™è¯¯ï¼Œæ­¤æ—¶ä¼šæ‰“å°å‡ºä¸€æ¡é”™è¯¯ä¿¡æ¯ã€‚

åœ¨æ–‡ä»¶çš„æœ€åéƒ¨åˆ†ï¼Œä½¿ç”¨ `if __name__ == "__main__":` è¯­å¥æ¥ç¡®ä¿åªæœ‰åœ¨ç›´æ¥è¿è¡Œè¯¥æ–‡ä»¶æ—¶æ‰ä¼šæ‰§è¡Œåé¢çš„ä»£ç ã€‚åœ¨è¿™é‡Œï¼ŒæŒ‡å®šäº†è¦è¿è¡Œçš„è„šæœ¬è·¯å¾„ä¸º `web.py`ï¼Œå¹¶è°ƒç”¨ `run_script` å‡½æ•°æ¥æ‰§è¡Œè¿™ä¸ªè„šæœ¬ã€‚

æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªç¨‹åºæ–‡ä»¶çš„åŠŸèƒ½æ˜¯é€šè¿‡å½“å‰çš„ Python ç¯å¢ƒè¿è¡Œä¸€ä¸ª Streamlit åº”ç”¨è„šæœ¬ï¼Œå¹¶åœ¨è¿è¡Œè¿‡ç¨‹ä¸­å¤„ç†å¯èƒ½å‡ºç°çš„é”™è¯¯ã€‚

#### 11.3 70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\trackers\byte_tracker.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å’Œæ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼Œä¸»è¦ä¿ç•™äº† `STrack` å’Œ `BYTETracker` ç±»çš„æ ¸å¿ƒåŠŸèƒ½ã€‚

```python
import numpy as np
from .basetrack import BaseTrack, TrackState
from .utils import matching
from .utils.kalman_filter import KalmanFilterXYAH

class STrack(BaseTrack):
    """
    å•ç›®æ ‡è·Ÿè¸ªè¡¨ç¤ºï¼Œä½¿ç”¨å¡å°”æ›¼æ»¤æ³¢è¿›è¡ŒçŠ¶æ€ä¼°è®¡ã€‚
    è¯¥ç±»è´Ÿè´£å­˜å‚¨å•ä¸ªè½¨è¿¹çš„ä¿¡æ¯ï¼Œå¹¶æ ¹æ®å¡å°”æ›¼æ»¤æ³¢è¿›è¡ŒçŠ¶æ€æ›´æ–°å’Œé¢„æµ‹ã€‚
    """

    shared_kalman = KalmanFilterXYAH()  # å…±äº«çš„å¡å°”æ›¼æ»¤æ³¢å™¨å®ä¾‹

    def __init__(self, tlwh, score, cls):
        """åˆå§‹åŒ–æ–°çš„STrackå®ä¾‹ã€‚"""
        # å°†è¾¹ç•Œæ¡†çš„tlwhæ ¼å¼è½¬æ¢ä¸ºå†…éƒ¨å­˜å‚¨æ ¼å¼
        self._tlwh = np.asarray(self.tlbr_to_tlwh(tlwh[:-1]), dtype=np.float32)
        self.kalman_filter = None  # ç‰¹å®šå¯¹è±¡çš„å¡å°”æ›¼æ»¤æ³¢å™¨
        self.mean, self.covariance = None, None  # çŠ¶æ€å‡å€¼å’Œåæ–¹å·®
        self.is_activated = False  # è·Ÿè¸ªæ˜¯å¦è¢«æ¿€æ´»çš„æ ‡å¿—

        self.score = score  # ç½®ä¿¡åº¦åˆ†æ•°
        self.tracklet_len = 0  # è½¨è¿¹é•¿åº¦
        self.cls = cls  # ç›®æ ‡ç±»åˆ«
        self.idx = tlwh[-1]  # ç›®æ ‡ç´¢å¼•

    def predict(self):
        """ä½¿ç”¨å¡å°”æ›¼æ»¤æ³¢å™¨é¢„æµ‹å¯¹è±¡çš„ä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚"""
        mean_state = self.mean.copy()  # å¤åˆ¶å½“å‰å‡å€¼çŠ¶æ€
        if self.state != TrackState.Tracked:
            mean_state[7] = 0  # å¦‚æœçŠ¶æ€ä¸æ˜¯è·Ÿè¸ªçŠ¶æ€ï¼Œè®¾ç½®é€Ÿåº¦ä¸º0
        self.mean, self.covariance = self.kalman_filter.predict(mean_state, self.covariance)

    def activate(self, kalman_filter, frame_id):
        """æ¿€æ´»æ–°çš„è½¨è¿¹ã€‚"""
        self.kalman_filter = kalman_filter  # è®¾ç½®å¡å°”æ›¼æ»¤æ³¢å™¨
        self.track_id = self.next_id()  # è·å–æ–°çš„è½¨è¿¹ID
        self.mean, self.covariance = self.kalman_filter.initiate(self.convert_coords(self._tlwh))  # åˆå§‹åŒ–çŠ¶æ€

        self.tracklet_len = 0  # é‡ç½®è½¨è¿¹é•¿åº¦
        self.state = TrackState.Tracked  # è®¾ç½®çŠ¶æ€ä¸ºè·Ÿè¸ª
        if frame_id == 1:
            self.is_activated = True  # å¦‚æœæ˜¯ç¬¬ä¸€å¸§ï¼Œæ¿€æ´»è½¨è¿¹
        self.frame_id = frame_id  # å½“å‰å¸§ID
        self.start_frame = frame_id  # è½¨è¿¹å¼€å§‹å¸§

    def update(self, new_track, frame_id):
        """æ›´æ–°åŒ¹é…è½¨è¿¹çš„çŠ¶æ€ã€‚"""
        self.frame_id = frame_id  # æ›´æ–°å½“å‰å¸§ID
        self.tracklet_len += 1  # å¢åŠ è½¨è¿¹é•¿åº¦

        new_tlwh = new_track.tlwh  # è·å–æ–°çš„è¾¹ç•Œæ¡†
        self.mean, self.covariance = self.kalman_filter.update(self.mean, self.covariance,
                                                               self.convert_coords(new_tlwh))  # æ›´æ–°çŠ¶æ€
        self.state = TrackState.Tracked  # è®¾ç½®çŠ¶æ€ä¸ºè·Ÿè¸ª
        self.is_activated = True  # æ¿€æ´»è½¨è¿¹

        self.score = new_track.score  # æ›´æ–°ç½®ä¿¡åº¦åˆ†æ•°
        self.cls = new_track.cls  # æ›´æ–°ç›®æ ‡ç±»åˆ«
        self.idx = new_track.idx  # æ›´æ–°ç›®æ ‡ç´¢å¼•

class BYTETracker:
    """
    BYTETracker: åŸºäºYOLOv8çš„ç›®æ ‡æ£€æµ‹å’Œè·Ÿè¸ªç®—æ³•ã€‚
    è¯¥ç±»è´Ÿè´£åˆå§‹åŒ–ã€æ›´æ–°å’Œç®¡ç†è§†é¢‘åºåˆ—ä¸­æ£€æµ‹åˆ°çš„å¯¹è±¡çš„è½¨è¿¹ã€‚
    """

    def __init__(self, args, frame_rate=30):
        """åˆå§‹åŒ–YOLOv8å¯¹è±¡ä»¥è·Ÿè¸ªç›®æ ‡ã€‚"""
        self.tracked_stracks = []  # æˆåŠŸæ¿€æ´»çš„è½¨è¿¹åˆ—è¡¨
        self.lost_stracks = []  # ä¸¢å¤±çš„è½¨è¿¹åˆ—è¡¨
        self.removed_stracks = []  # ç§»é™¤çš„è½¨è¿¹åˆ—è¡¨

        self.frame_id = 0  # å½“å‰å¸§ID
        self.args = args  # å‘½ä»¤è¡Œå‚æ•°
        self.max_time_lost = int(frame_rate / 30.0 * args.track_buffer)  # æœ€å¤§ä¸¢å¤±æ—¶é—´
        self.kalman_filter = self.get_kalmanfilter()  # è·å–å¡å°”æ›¼æ»¤æ³¢å™¨
        self.reset_id()  # é‡ç½®ID

    def update(self, results, img=None):
        """ä½¿ç”¨æ–°æ£€æµ‹æ›´æ–°å¯¹è±¡è·Ÿè¸ªå™¨ã€‚"""
        self.frame_id += 1  # å¢åŠ å¸§ID
        activated_stracks = []  # æ¿€æ´»çš„è½¨è¿¹
        refind_stracks = []  # é‡æ–°æ‰¾åˆ°çš„è½¨è¿¹
        lost_stracks = []  # ä¸¢å¤±çš„è½¨è¿¹
        removed_stracks = []  # ç§»é™¤çš„è½¨è¿¹

        scores = results.conf  # è·å–ç½®ä¿¡åº¦åˆ†æ•°
        bboxes = results.xyxy  # è·å–è¾¹ç•Œæ¡†
        bboxes = np.concatenate([bboxes, np.arange(len(bboxes)).reshape(-1, 1)], axis=-1)  # æ·»åŠ ç´¢å¼•
        cls = results.cls  # è·å–ç±»åˆ«

        # æ ¹æ®ç½®ä¿¡åº¦é˜ˆå€¼ç­›é€‰æ£€æµ‹
        remain_inds = scores > self.args.track_high_thresh
        dets = bboxes[remain_inds]  # é«˜ç½®ä¿¡åº¦æ£€æµ‹
        scores_keep = scores[remain_inds]  # ä¿ç•™çš„åˆ†æ•°
        cls_keep = cls[remain_inds]  # ä¿ç•™çš„ç±»åˆ«

        # åˆå§‹åŒ–æ–°çš„è½¨è¿¹
        detections = self.init_track(dets, scores_keep, cls_keep, img)
        # å¤„ç†å·²è·Ÿè¸ªçš„è½¨è¿¹
        unconfirmed = [track for track in self.tracked_stracks if not track.is_activated]
        tracked_stracks = [track for track in self.tracked_stracks if track.is_activated]

        # è¿›è¡Œå¡å°”æ›¼æ»¤æ³¢é¢„æµ‹
        strack_pool = self.joint_stracks(tracked_stracks, self.lost_stracks)
        self.multi_predict(strack_pool)

        # è®¡ç®—è·ç¦»å¹¶è¿›è¡ŒåŒ¹é…
        dists = self.get_dists(strack_pool, detections)
        matches, u_track, u_detection = matching.linear_assignment(dists, thresh=self.args.match_thresh)

        # æ›´æ–°åŒ¹é…çš„è½¨è¿¹
        for itracked, idet in matches:
            track = strack_pool[itracked]
            det = detections[idet]
            track.update(det, self.frame_id)  # æ›´æ–°è½¨è¿¹
            activated_stracks.append(track)  # æ·»åŠ åˆ°æ¿€æ´»è½¨è¿¹åˆ—è¡¨

        # å¤„ç†æœªç¡®è®¤çš„è½¨è¿¹
        for it in u_track:
            track = strack_pool[it]
            if track.state != TrackState.Lost:
                track.mark_lost()  # æ ‡è®°ä¸ºä¸¢å¤±
                lost_stracks.append(track)  # æ·»åŠ åˆ°ä¸¢å¤±è½¨è¿¹åˆ—è¡¨

        # åˆå§‹åŒ–æ–°çš„è½¨è¿¹
        for inew in u_detection:
            track = detections[inew]
            if track.score < self.args.new_track_thresh:
                continue
            track.activate(self.kalman_filter, self.frame_id)  # æ¿€æ´»æ–°è½¨è¿¹
            activated_stracks.append(track)

        # æ›´æ–°çŠ¶æ€
        self.tracked_stracks = self.joint_stracks(self.tracked_stracks, activated_stracks)
        self.lost_stracks = self.sub_stracks(self.lost_stracks, self.tracked_stracks)

        return np.asarray(
            [x.tlbr.tolist() + [x.track_id, x.score, x.cls, x.idx] for x in self.tracked_stracks if x.is_activated],
            dtype=np.float32)  # è¿”å›æ¿€æ´»çš„è½¨è¿¹ä¿¡æ¯
```

### ä»£ç æ³¨é‡Šè¯´æ˜
1. **STrack ç±»**: è´Ÿè´£å•ä¸ªç›®æ ‡çš„è·Ÿè¸ªï¼Œä½¿ç”¨å¡å°”æ›¼æ»¤æ³¢å™¨è¿›è¡ŒçŠ¶æ€é¢„æµ‹å’Œæ›´æ–°ã€‚
   - `__init__`: åˆå§‹åŒ–è·Ÿè¸ªå¯¹è±¡ï¼Œè®¾ç½®åˆå§‹çŠ¶æ€å’Œå±æ€§ã€‚
   - `predict`: é¢„æµ‹ä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚
   - `activate`: æ¿€æ´»æ–°çš„è½¨è¿¹ã€‚
   - `update`: æ›´æ–°è½¨è¿¹çŠ¶æ€ã€‚

2. **BYTETracker ç±»**: è´Ÿè´£æ•´ä½“çš„ç›®æ ‡è·Ÿè¸ªç®¡ç†ï¼Œå¤„ç†å¤šç›®æ ‡çš„æ¿€æ´»ã€ä¸¢å¤±å’Œæ›´æ–°ã€‚
   - `__init__`: åˆå§‹åŒ–è·Ÿè¸ªå™¨ï¼Œè®¾ç½®å‚æ•°å’ŒçŠ¶æ€ã€‚
   - `update`: æ›´æ–°è·Ÿè¸ªå™¨ï¼Œå¤„ç†æ–°æ£€æµ‹çš„ç›®æ ‡ï¼Œè¿›è¡ŒåŒ¹é…å’ŒçŠ¶æ€æ›´æ–°ã€‚

é€šè¿‡è¿™äº›æ ¸å¿ƒåŠŸèƒ½ï¼Œ`STrack` å’Œ `BYTETracker` ç±»å®ç°äº†åŸºäºå¡å°”æ›¼æ»¤æ³¢çš„ç›®æ ‡è·Ÿè¸ªç®—æ³•ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶æ˜¯ä¸€ä¸ªå®ç°å¯¹è±¡è·Ÿè¸ªçš„æ¨¡å—ï¼Œä¸»è¦åŸºäºYOLOv8ç®—æ³•ï¼Œä½¿ç”¨äº†å¡å°”æ›¼æ»¤æ³¢å™¨æ¥è¿›è¡ŒçŠ¶æ€ä¼°è®¡å’Œé¢„æµ‹ã€‚æ–‡ä»¶ä¸­å®šä¹‰äº†ä¸¤ä¸ªä¸»è¦çš„ç±»ï¼š`STrack`å’Œ`BYTETracker`ã€‚

`STrack`ç±»ç”¨äºè¡¨ç¤ºå•ä¸ªå¯¹è±¡çš„è·Ÿè¸ªä¿¡æ¯ã€‚å®ƒé€šè¿‡å¡å°”æ›¼æ»¤æ³¢å™¨æ¥æ›´æ–°å’Œé¢„æµ‹å¯¹è±¡çš„çŠ¶æ€ã€‚è¯¥ç±»åŒ…å«å¤šä¸ªå±æ€§ï¼Œä¾‹å¦‚ç”¨äºå­˜å‚¨è¾¹ç•Œæ¡†çš„åæ ‡å’Œå°ºå¯¸çš„`_tlwh`ï¼Œç”¨äºçŠ¶æ€ä¼°è®¡çš„å‡å€¼å’Œåæ–¹å·®ï¼Œè·Ÿè¸ªçš„æ¿€æ´»çŠ¶æ€ã€ç½®ä¿¡åº¦åˆ†æ•°ã€è·Ÿè¸ªé•¿åº¦ã€ç±»åˆ«æ ‡ç­¾å’Œç´¢å¼•ç­‰ã€‚`STrack`ç±»çš„æ–¹æ³•åŒ…æ‹¬é¢„æµ‹ä¸‹ä¸€ä¸ªçŠ¶æ€ã€æ¿€æ´»æ–°çš„è·Ÿè¸ªã€æ›´æ–°åŒ¹é…çš„è·Ÿè¸ªçŠ¶æ€ç­‰ã€‚æ­¤å¤–ï¼Œç±»ä¸­è¿˜æä¾›äº†åæ ‡è½¬æ¢çš„æ–¹æ³•ï¼Œå°†ä¸åŒæ ¼å¼çš„è¾¹ç•Œæ¡†è¿›è¡Œè½¬æ¢ã€‚

`BYTETracker`ç±»åˆ™æ˜¯ä¸€ä¸ªæ›´é«˜å±‚æ¬¡çš„è·Ÿè¸ªç®—æ³•ï¼Œè´Ÿè´£ç®¡ç†å’Œæ›´æ–°æ£€æµ‹åˆ°çš„å¯¹è±¡çš„è·Ÿè¸ªçŠ¶æ€ã€‚å®ƒç»´æŠ¤äº†è·Ÿè¸ªæˆåŠŸã€ä¸¢å¤±å’Œç§»é™¤çš„è·Ÿè¸ªåˆ—è¡¨ï¼Œå¹¶åˆ©ç”¨å¡å°”æ›¼æ»¤æ³¢å™¨é¢„æµ‹æ–°çš„å¯¹è±¡ä½ç½®ã€‚è¯¥ç±»çš„ä¸»è¦æ–¹æ³•åŒ…æ‹¬æ›´æ–°è·Ÿè¸ªå™¨ä»¥å¤„ç†æ–°çš„æ£€æµ‹ç»“æœã€åˆå§‹åŒ–è·Ÿè¸ªã€è®¡ç®—è·Ÿè¸ªä¸æ£€æµ‹ä¹‹é—´çš„è·ç¦»ã€ä»¥åŠå¤„ç†è·Ÿè¸ªçš„åˆå¹¶å’Œå»é‡ç­‰ã€‚

åœ¨`update`æ–¹æ³•ä¸­ï¼Œé¦–å…ˆæ›´æ–°å½“å‰å¸§IDï¼Œå¹¶å¤„ç†æ–°çš„æ£€æµ‹ç»“æœã€‚é€šè¿‡è®¡ç®—è·Ÿè¸ªå’Œæ£€æµ‹ä¹‹é—´çš„è·ç¦»ï¼Œè¿›è¡Œæ•°æ®å…³è”ï¼Œæ¿€æ´»æ–°çš„è·Ÿè¸ªæˆ–é‡æ–°æ¿€æ´»ä¸¢å¤±çš„è·Ÿè¸ªã€‚æ–¹æ³•è¿˜å¤„ç†äº†æœªç¡®è®¤çš„è·Ÿè¸ªï¼Œåˆå§‹åŒ–æ–°çš„è·Ÿè¸ªï¼Œå¹¶æ›´æ–°çŠ¶æ€ä»¥ç§»é™¤è¶…æ—¶çš„è·Ÿè¸ªã€‚

æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªç¨‹åºæ–‡ä»¶å®ç°äº†ä¸€ä¸ªå®Œæ•´çš„å¯¹è±¡è·Ÿè¸ªç³»ç»Ÿï¼Œç»“åˆäº†YOLOv8çš„æ£€æµ‹èƒ½åŠ›å’Œå¡å°”æ›¼æ»¤æ³¢å™¨çš„é¢„æµ‹èƒ½åŠ›ï¼Œèƒ½å¤Ÿåœ¨è§†é¢‘åºåˆ—ä¸­æœ‰æ•ˆåœ°è·Ÿè¸ªå¤šä¸ªå¯¹è±¡ã€‚

#### 11.4 code\utils.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
import os
import cv2
import pandas as pd
import streamlit as st
from PIL import Image
from QtFusion.path import abs_path

def save_uploaded_file(uploaded_file):
    """
    ä¿å­˜ä¸Šä¼ çš„æ–‡ä»¶åˆ°æœåŠ¡å™¨ä¸Šã€‚

    Args:
        uploaded_file (UploadedFile): é€šè¿‡Streamlitä¸Šä¼ çš„æ–‡ä»¶ã€‚

    Returns:
        str: ä¿å­˜æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ï¼Œå¦‚æœæ²¡æœ‰æ–‡ä»¶ä¸Šä¼ åˆ™è¿”å› Noneã€‚
    """
    # æ£€æŸ¥æ˜¯å¦æœ‰æ–‡ä»¶ä¸Šä¼ 
    if uploaded_file is not None:
        base_path = "tempDir"  # å®šä¹‰æ–‡ä»¶ä¿å­˜çš„åŸºæœ¬è·¯å¾„

        # å¦‚æœè·¯å¾„ä¸å­˜åœ¨ï¼Œåˆ›å»ºè¿™ä¸ªè·¯å¾„
        if not os.path.exists(base_path):
            os.makedirs(base_path)
        
        # è·å–æ–‡ä»¶çš„å®Œæ•´è·¯å¾„
        file_path = os.path.join(base_path, uploaded_file.name)

        # ä»¥äºŒè¿›åˆ¶å†™æ¨¡å¼æ‰“å¼€æ–‡ä»¶
        with open(file_path, "wb") as f:
            f.write(uploaded_file.getbuffer())  # å°†ä¸Šä¼ çš„æ–‡ä»¶å†…å®¹å†™å…¥åˆ°æŒ‡å®šè·¯å¾„

        return file_path  # è¿”å›æ–‡ä»¶çš„å®Œæ•´è·¯å¾„

    return None  # å¦‚æœæ²¡æœ‰æ–‡ä»¶ä¸Šä¼ ï¼Œè¿”å› None


def concat_results(result, location, confidence, time):
    """
    æ˜¾ç¤ºæ£€æµ‹ç»“æœã€‚

    Args:
        result (str): æ£€æµ‹ç»“æœã€‚
        location (str): æ£€æµ‹ä½ç½®ã€‚
        confidence (str): ç½®ä¿¡åº¦ã€‚
        time (str): æ£€æµ‹ç”¨æ—¶ã€‚

    Returns:
        DataFrame: åŒ…å«æ£€æµ‹ç»“æœçš„ DataFrameã€‚
    """
    # åˆ›å»ºä¸€ä¸ªåŒ…å«è¿™äº›ä¿¡æ¯çš„å­—å…¸
    result_data = {
        "è¯†åˆ«ç»“æœ": [result],
        "ä½ç½®": [location],
        "ç½®ä¿¡åº¦": [confidence],
        "ç”¨æ—¶": [time]
    }

    # å°†å­—å…¸è½¬æ¢ä¸º DataFrame
    results_df = pd.DataFrame(result_data)
    return results_df  # è¿”å›ç»“æœçš„ DataFrame


def get_camera_names():
    """
    è·å–å¯ç”¨æ‘„åƒå¤´åç§°åˆ—è¡¨ã€‚

    Returns:
        list: è¿”å›åŒ…å«â€œæœªå¯ç”¨æ‘„åƒå¤´â€å’Œå¯ç”¨æ‘„åƒå¤´ç´¢å¼•å·çš„åˆ—è¡¨ã€‚
    """
    camera_names = ["æ‘„åƒå¤´æ£€æµ‹å…³é—­", "0"]  # åˆå§‹åŒ–æ‘„åƒå¤´åç§°åˆ—è¡¨
    max_test_cameras = 10  # å®šä¹‰è¦æµ‹è¯•çš„æœ€å¤§æ‘„åƒå¤´æ•°é‡

    # æµ‹è¯•å¯ç”¨çš„æ‘„åƒå¤´
    for i in range(max_test_cameras):
        cap = cv2.VideoCapture(i, cv2.CAP_DSHOW)  # å°è¯•æ‰“å¼€æ‘„åƒå¤´
        if cap.isOpened() and str(i) not in camera_names:  # å¦‚æœæ‘„åƒå¤´æˆåŠŸæ‰“å¼€ä¸”æœªåœ¨åˆ—è¡¨ä¸­
            camera_names.append(str(i))  # å°†æ‘„åƒå¤´ç´¢å¼•æ·»åŠ åˆ°åˆ—è¡¨
            cap.release()  # é‡Šæ”¾æ‘„åƒå¤´èµ„æº
    
    # å¦‚æœæ²¡æœ‰æ‰¾åˆ°å¯ç”¨çš„æ‘„åƒå¤´ï¼Œè¾“å‡ºæç¤ºä¿¡æ¯
    if len(camera_names) == 1:
        st.write("æœªæ‰¾åˆ°å¯ç”¨çš„æ‘„åƒå¤´")
    
    return camera_names  # è¿”å›å¯ç”¨æ‘„åƒå¤´çš„åç§°åˆ—è¡¨
```

### ä»£ç è¯´æ˜ï¼š
1. **save_uploaded_file**: è¯¥å‡½æ•°ç”¨äºä¿å­˜ç”¨æˆ·é€šè¿‡Streamlitä¸Šä¼ çš„æ–‡ä»¶åˆ°æœåŠ¡å™¨çš„æŒ‡å®šç›®å½•ä¸­ã€‚å®ƒé¦–å…ˆæ£€æŸ¥æ˜¯å¦æœ‰æ–‡ä»¶ä¸Šä¼ ï¼Œå¦‚æœæœ‰ï¼Œåˆ™åˆ›å»ºä¿å­˜ç›®å½•å¹¶å°†æ–‡ä»¶å†™å…¥è¯¥ç›®å½•ï¼Œæœ€åè¿”å›æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ã€‚

2. **concat_results**: è¯¥å‡½æ•°ç”¨äºå°†æ£€æµ‹ç»“æœã€ä½ç½®ã€ç½®ä¿¡åº¦å’Œç”¨æ—¶ä¿¡æ¯æ•´åˆåˆ°ä¸€ä¸ªPandas DataFrameä¸­ï¼Œä»¥ä¾¿åç»­å¤„ç†æˆ–å±•ç¤ºã€‚

3. **get_camera_names**: è¯¥å‡½æ•°ç”¨äºæ£€æµ‹ç³»ç»Ÿä¸­å¯ç”¨çš„æ‘„åƒå¤´ã€‚å®ƒå°è¯•æ‰“å¼€å¤šä¸ªç´¢å¼•å·çš„æ‘„åƒå¤´ï¼Œå¹¶å°†æˆåŠŸæ‰“å¼€çš„æ‘„åƒå¤´ç´¢å¼•æ·»åŠ åˆ°åˆ—è¡¨ä¸­ï¼Œæœ€åè¿”å›å¯ç”¨æ‘„åƒå¤´çš„åç§°åˆ—è¡¨ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶ `code/utils.py` åŒ…å«äº†ä¸€äº›ç”¨äºå¤„ç†æ–‡ä»¶ä¸Šä¼ ã€æ˜¾ç¤ºæ£€æµ‹ç»“æœã€åŠ è½½é»˜è®¤å›¾ç‰‡ä»¥åŠè·å–å¯ç”¨æ‘„åƒå¤´åç§°çš„å®ç”¨å‡½æ•°ã€‚

é¦–å…ˆï¼Œ`save_uploaded_file` å‡½æ•°ç”¨äºä¿å­˜ç”¨æˆ·é€šè¿‡ Streamlit ä¸Šä¼ çš„æ–‡ä»¶ã€‚å®ƒæ¥æ”¶ä¸€ä¸ªä¸Šä¼ çš„æ–‡ä»¶å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰æ–‡ä»¶è¢«ä¸Šä¼ ã€‚å¦‚æœæœ‰ï¼Œå‡½æ•°ä¼šåœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºä¸€ä¸ªåä¸º `tempDir` çš„ç›®å½•ï¼ˆå¦‚æœè¯¥ç›®å½•ä¸å­˜åœ¨ï¼‰ï¼Œç„¶åå°†ä¸Šä¼ çš„æ–‡ä»¶ä»¥äºŒè¿›åˆ¶æ ¼å¼å†™å…¥åˆ°è¿™ä¸ªç›®å½•ä¸­ï¼Œå¹¶è¿”å›æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ã€‚å¦‚æœæ²¡æœ‰æ–‡ä»¶ä¸Šä¼ ï¼Œåˆ™è¿”å› `None`ã€‚

æ¥ä¸‹æ¥ï¼Œ`concat_results` å‡½æ•°ç”¨äºæ˜¾ç¤ºæ£€æµ‹ç»“æœã€‚å®ƒæ¥æ”¶æ£€æµ‹ç»“æœã€ä½ç½®ã€ç½®ä¿¡åº¦å’Œæ£€æµ‹ç”¨æ—¶ä½œä¸ºå‚æ•°ï¼Œå¹¶å°†è¿™äº›ä¿¡æ¯ç»„ç»‡æˆä¸€ä¸ª Pandas DataFrameï¼Œæ–¹ä¾¿åç»­çš„å±•ç¤ºå’Œå¤„ç†ã€‚

`load_default_image` å‡½æ•°ç”¨äºåŠ è½½ä¸€ä¸ªé»˜è®¤çš„å›¾ç‰‡ã€‚å®ƒé€šè¿‡è°ƒç”¨ `abs_path` å‡½æ•°è·å–é»˜è®¤å›¾ç‰‡çš„ç»å¯¹è·¯å¾„ï¼Œç„¶åä½¿ç”¨ PIL åº“æ‰“å¼€è¿™ä¸ªå›¾ç‰‡å¹¶è¿”å›å…¶å¯¹è±¡ã€‚

æœ€åï¼Œ`get_camera_names` å‡½æ•°ç”¨äºè·å–å¯ç”¨æ‘„åƒå¤´çš„åç§°åˆ—è¡¨ã€‚å®ƒåˆå§‹åŒ–ä¸€ä¸ªåŒ…å«â€œæ‘„åƒå¤´æ£€æµ‹å…³é—­â€å’Œç´¢å¼•â€œ0â€çš„åˆ—è¡¨ï¼Œå¹¶å°è¯•æ‰“å¼€æœ€å¤š 10 ä¸ªæ‘„åƒå¤´ã€‚å¦‚æœæˆåŠŸæ‰“å¼€æŸä¸ªæ‘„åƒå¤´ï¼Œåˆ™å°†å…¶ç´¢å¼•æ·»åŠ åˆ°åˆ—è¡¨ä¸­ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°å¯ç”¨çš„æ‘„åƒå¤´ï¼Œå‡½æ•°ä¼šåœ¨ Streamlit ç•Œé¢ä¸Šè¾“å‡ºæç¤ºä¿¡æ¯ã€‚æœ€ç»ˆï¼Œè¯¥å‡½æ•°è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å¯ç”¨æ‘„åƒå¤´åç§°çš„åˆ—è¡¨ã€‚

æ€»ä½“æ¥è¯´ï¼Œè¿™ä¸ªæ–‡ä»¶æä¾›äº†ä¸€äº›åŸºæœ¬çš„å·¥å…·å‡½æ•°ï¼Œæ—¨åœ¨æ”¯æŒä¸æ–‡ä»¶ä¸Šä¼ ã€å›¾åƒå¤„ç†å’Œæ‘„åƒå¤´æ£€æµ‹ç›¸å…³çš„åŠŸèƒ½ã€‚

#### 11.5 train.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
class DetectionTrainer(BaseTrainer):
    """
    DetectionTrainerç±»ï¼Œç»§æ‰¿è‡ªBaseTrainerç±»ï¼Œç”¨äºåŸºäºæ£€æµ‹æ¨¡å‹çš„è®­ç»ƒã€‚
    """

    def build_dataset(self, img_path, mode="train", batch=None):
        """
        æ„å»ºYOLOæ•°æ®é›†ã€‚

        å‚æ•°:
            img_path (str): åŒ…å«å›¾åƒçš„æ–‡ä»¶å¤¹è·¯å¾„ã€‚
            mode (str): æ¨¡å¼ï¼Œå¯ä»¥æ˜¯'train'æˆ–'val'ï¼Œç”¨æˆ·å¯ä»¥ä¸ºæ¯ç§æ¨¡å¼è‡ªå®šä¹‰ä¸åŒçš„æ•°æ®å¢å¼ºã€‚
            batch (int, optional): æ‰¹æ¬¡å¤§å°ï¼Œä»…ç”¨äº'rect'æ¨¡å¼ã€‚é»˜è®¤ä¸ºNoneã€‚
        """
        gs = max(int(de_parallel(self.model).stride.max() if self.model else 0), 32)
        return build_yolo_dataset(self.args, img_path, batch, self.data, mode=mode, rect=mode == "val", stride=gs)

    def get_dataloader(self, dataset_path, batch_size=16, rank=0, mode="train"):
        """æ„é€ å¹¶è¿”å›æ•°æ®åŠ è½½å™¨ã€‚"""
        assert mode in ["train", "val"]  # ç¡®ä¿æ¨¡å¼æ˜¯'train'æˆ–'val'
        with torch_distributed_zero_first(rank):  # åœ¨åˆ†å¸ƒå¼è®­ç»ƒä¸­ï¼Œä»…åˆå§‹åŒ–æ•°æ®é›†ä¸€æ¬¡
            dataset = self.build_dataset(dataset_path, mode, batch_size)  # æ„å»ºæ•°æ®é›†
        shuffle = mode == "train"  # è®­ç»ƒæ¨¡å¼ä¸‹æ‰“ä¹±æ•°æ®
        if getattr(dataset, "rect", False) and shuffle:
            LOGGER.warning("WARNING âš ï¸ 'rect=True'ä¸DataLoaderçš„shuffleä¸å…¼å®¹ï¼Œè®¾ç½®shuffle=False")
            shuffle = False
        workers = self.args.workers if mode == "train" else self.args.workers * 2  # è®¾ç½®å·¥ä½œçº¿ç¨‹æ•°
        return build_dataloader(dataset, batch_size, workers, shuffle, rank)  # è¿”å›æ•°æ®åŠ è½½å™¨

    def preprocess_batch(self, batch):
        """å¯¹ä¸€æ‰¹å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬ç¼©æ”¾å’Œè½¬æ¢ä¸ºæµ®ç‚¹æ•°ã€‚"""
        batch["img"] = batch["img"].to(self.device, non_blocking=True).float() / 255  # å°†å›¾åƒè½¬æ¢ä¸ºæµ®ç‚¹æ•°å¹¶å½’ä¸€åŒ–
        if self.args.multi_scale:  # å¦‚æœå¯ç”¨å¤šå°ºåº¦è®­ç»ƒ
            imgs = batch["img"]
            sz = (
                random.randrange(self.args.imgsz * 0.5, self.args.imgsz * 1.5 + self.stride)
                // self.stride
                * self.stride
            )  # éšæœºé€‰æ‹©å›¾åƒå¤§å°
            sf = sz / max(imgs.shape[2:])  # è®¡ç®—ç¼©æ”¾å› å­
            if sf != 1:  # å¦‚æœç¼©æ”¾å› å­ä¸ä¸º1
                ns = [
                    math.ceil(x * sf / self.stride) * self.stride for x in imgs.shape[2:]
                ]  # è®¡ç®—æ–°çš„å½¢çŠ¶
                imgs = nn.functional.interpolate(imgs, size=ns, mode="bilinear", align_corners=False)  # è¿›è¡Œæ’å€¼ç¼©æ”¾
            batch["img"] = imgs  # æ›´æ–°æ‰¹æ¬¡ä¸­çš„å›¾åƒ
        return batch

    def get_model(self, cfg=None, weights=None, verbose=True):
        """è¿”å›YOLOæ£€æµ‹æ¨¡å‹ã€‚"""
        model = DetectionModel(cfg, nc=self.data["nc"], verbose=verbose and RANK == -1)  # åˆ›å»ºæ£€æµ‹æ¨¡å‹
        if weights:
            model.load(weights)  # åŠ è½½æƒé‡
        return model

    def get_validator(self):
        """è¿”å›ç”¨äºYOLOæ¨¡å‹éªŒè¯çš„DetectionValidatorã€‚"""
        self.loss_names = "box_loss", "cls_loss", "dfl_loss"  # å®šä¹‰æŸå¤±åç§°
        return yolo.detect.DetectionValidator(
            self.test_loader, save_dir=self.save_dir, args=copy(self.args), _callbacks=self.callbacks
        )  # è¿”å›éªŒè¯å™¨

    def plot_training_samples(self, batch, ni):
        """ç»˜åˆ¶å¸¦æœ‰æ³¨é‡Šçš„è®­ç»ƒæ ·æœ¬ã€‚"""
        plot_images(
            images=batch["img"],
            batch_idx=batch["batch_idx"],
            cls=batch["cls"].squeeze(-1),
            bboxes=batch["bboxes"],
            paths=batch["im_file"],
            fname=self.save_dir / f"train_batch{ni}.jpg",
            on_plot=self.on_plot,
        )  # ç»˜åˆ¶å›¾åƒ

    def plot_metrics(self):
        """ä»CSVæ–‡ä»¶ä¸­ç»˜åˆ¶æŒ‡æ ‡ã€‚"""
        plot_results(file=self.csv, on_plot=self.on_plot)  # ä¿å­˜ç»“æœå›¾
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†è§£é‡Šï¼š
1. **DetectionTrainerç±»**ï¼šè¿™æ˜¯ä¸€ä¸ªç”¨äºè®­ç»ƒYOLOæ£€æµ‹æ¨¡å‹çš„ç±»ï¼Œç»§æ‰¿è‡ªåŸºæœ¬è®­ç»ƒå™¨ç±»`BaseTrainer`ã€‚
2. **build_datasetæ–¹æ³•**ï¼šæ„å»ºYOLOæ•°æ®é›†ï¼Œæ”¯æŒè®­ç»ƒå’ŒéªŒè¯æ¨¡å¼ã€‚
3. **get_dataloaderæ–¹æ³•**ï¼šæ„é€ æ•°æ®åŠ è½½å™¨ï¼Œæ”¯æŒåˆ†å¸ƒå¼è®­ç»ƒã€‚
4. **preprocess_batchæ–¹æ³•**ï¼šå¯¹å›¾åƒæ‰¹æ¬¡è¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬å½’ä¸€åŒ–å’Œå¤šå°ºåº¦å¤„ç†ã€‚
5. **get_modelæ–¹æ³•**ï¼šè¿”å›YOLOæ£€æµ‹æ¨¡å‹ï¼Œå¹¶å¯é€‰æ‹©åŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚
6. **get_validatoræ–¹æ³•**ï¼šè¿”å›ç”¨äºæ¨¡å‹éªŒè¯çš„éªŒè¯å™¨ã€‚
7. **plot_training_sampleså’Œplot_metricsæ–¹æ³•**ï¼šç”¨äºå¯è§†åŒ–è®­ç»ƒæ ·æœ¬å’Œè®­ç»ƒæŒ‡æ ‡ã€‚

è¿™äº›æ–¹æ³•å’Œç±»æ˜¯YOLOæ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­çš„å…³é”®éƒ¨åˆ†ï¼Œè´Ÿè´£æ•°æ®å‡†å¤‡ã€æ¨¡å‹æ„å»ºã€è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŸå¤±è®¡ç®—å’Œç»“æœå¯è§†åŒ–ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶ `train.py` æ˜¯ä¸€ä¸ªç”¨äºè®­ç»ƒ YOLOï¼ˆYou Only Look Onceï¼‰ç›®æ ‡æ£€æµ‹æ¨¡å‹çš„è„šæœ¬ï¼Œç»§æ‰¿è‡ª `BaseTrainer` ç±»ã€‚å®ƒåŒ…å«äº†ä¸€ç³»åˆ—æ–¹æ³•ï¼Œç”¨äºæ„å»ºæ•°æ®é›†ã€è·å–æ•°æ®åŠ è½½å™¨ã€é¢„å¤„ç†å›¾åƒæ‰¹æ¬¡ã€è®¾ç½®æ¨¡å‹å±æ€§ã€è·å–æ¨¡å‹ã€è¿›è¡ŒéªŒè¯ã€è®°å½•æŸå¤±ã€æ˜¾ç¤ºè®­ç»ƒè¿›åº¦ã€ç»˜åˆ¶è®­ç»ƒæ ·æœ¬å’Œç»˜åˆ¶è®­ç»ƒæŒ‡æ ‡ç­‰ã€‚

åœ¨æ–‡ä»¶å¼€å¤´ï¼Œå¯¼å…¥äº†ä¸€äº›å¿…è¦çš„åº“å’Œæ¨¡å—ï¼ŒåŒ…æ‹¬æ•°å­¦è¿ç®—ã€éšæœºæ•°ç”Ÿæˆã€æ·±åº¦å­¦ä¹ æ¡†æ¶ PyTorch çš„ç¥ç»ç½‘ç»œæ¨¡å—ã€ä»¥åŠ Ultralytics æä¾›çš„ç›¸å…³å·¥å…·å’Œæ•°æ®å¤„ç†æ¨¡å—ã€‚

`DetectionTrainer` ç±»çš„ä¸»è¦åŠŸèƒ½æ˜¯æ„å»ºå’Œè®­ç»ƒ YOLO æ¨¡å‹ã€‚å®ƒçš„ `build_dataset` æ–¹æ³•ç”¨äºæ ¹æ®æŒ‡å®šçš„å›¾åƒè·¯å¾„å’Œæ¨¡å¼ï¼ˆè®­ç»ƒæˆ–éªŒè¯ï¼‰æ„å»º YOLO æ•°æ®é›†ï¼Œæ”¯æŒä¸åŒçš„å¢å¼ºæ–¹å¼ã€‚`get_dataloader` æ–¹æ³•åˆ™æ„å»ºå¹¶è¿”å›æ•°æ®åŠ è½½å™¨ï¼Œç¡®ä¿åœ¨åˆ†å¸ƒå¼è®­ç»ƒæ—¶åªåˆå§‹åŒ–ä¸€æ¬¡æ•°æ®é›†ï¼Œå¹¶æ ¹æ®æ¨¡å¼è®¾ç½®æ˜¯å¦æ‰“ä¹±æ•°æ®ã€‚

åœ¨å›¾åƒé¢„å¤„ç†æ–¹é¢ï¼Œ`preprocess_batch` æ–¹æ³•å°†å›¾åƒæ‰¹æ¬¡ç¼©æ”¾å¹¶è½¬æ¢ä¸ºæµ®ç‚¹æ•°ï¼Œæ”¯æŒå¤šå°ºåº¦è®­ç»ƒã€‚`set_model_attributes` æ–¹æ³•ç”¨äºè®¾ç½®æ¨¡å‹çš„å±æ€§ï¼ŒåŒ…æ‹¬ç±»åˆ«æ•°é‡å’Œç±»åˆ«åç§°ã€‚

`get_model` æ–¹æ³•è¿”å›ä¸€ä¸ª YOLO æ£€æµ‹æ¨¡å‹ï¼Œå¹¶å¯ä»¥åŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚`get_validator` æ–¹æ³•è¿”å›ä¸€ä¸ªç”¨äºæ¨¡å‹éªŒè¯çš„ `DetectionValidator` å®ä¾‹ï¼Œè´Ÿè´£è®¡ç®—æŸå¤±å’Œè¯„ä¼°æ¨¡å‹æ€§èƒ½ã€‚

åœ¨æŸå¤±è®°å½•æ–¹é¢ï¼Œ`label_loss_items` æ–¹æ³•è¿”å›ä¸€ä¸ªåŒ…å«è®­ç»ƒæŸå¤±é¡¹çš„å­—å…¸ï¼Œä¾¿äºç›‘æ§è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŸå¤±å˜åŒ–ã€‚`progress_string` æ–¹æ³•æ ¼å¼åŒ–å¹¶è¿”å›è®­ç»ƒè¿›åº¦çš„å­—ç¬¦ä¸²ï¼ŒåŒ…æ‹¬å½“å‰çš„è½®æ¬¡ã€GPU å†…å­˜ä½¿ç”¨æƒ…å†µã€æŸå¤±å€¼ã€å®ä¾‹æ•°é‡å’Œå›¾åƒå¤§å°ã€‚

æ­¤å¤–ï¼Œ`plot_training_samples` æ–¹æ³•ç”¨äºç»˜åˆ¶è®­ç»ƒæ ·æœ¬åŠå…¶æ ‡æ³¨ï¼Œ`plot_metrics` æ–¹æ³•ä» CSV æ–‡ä»¶ä¸­ç»˜åˆ¶è®­ç»ƒæŒ‡æ ‡ï¼Œ`plot_training_labels` æ–¹æ³•åˆ›å»ºä¸€ä¸ªå¸¦æ ‡ç­¾çš„è®­ç»ƒå›¾ï¼Œå±•ç¤ºè®­ç»ƒæ•°æ®çš„æ ‡æ³¨æƒ…å†µã€‚

æ€»ä½“è€Œè¨€ï¼Œè¿™ä¸ªæ–‡ä»¶æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„æ¡†æ¶ï¼Œç”¨äºè®­ç»ƒ YOLO æ¨¡å‹ï¼Œæ¶µç›–äº†æ•°æ®å¤„ç†ã€æ¨¡å‹æ„å»ºã€è®­ç»ƒç›‘æ§å’Œç»“æœå¯è§†åŒ–ç­‰å¤šä¸ªæ–¹é¢ã€‚

#### 11.6 code\ultralytics\models\sam\modules\encoders.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å¹¶æ·»åŠ è¯¦ç»†ä¸­æ–‡æ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼š

```python
import torch
import torch.nn as nn
import torch.nn.functional as F

class ImageEncoderViT(nn.Module):
    """
    ä½¿ç”¨è§†è§‰å˜æ¢å™¨ï¼ˆViTï¼‰æ¶æ„çš„å›¾åƒç¼–ç å™¨ï¼Œå°†å›¾åƒç¼–ç ä¸ºç´§å‡‘çš„æ½œåœ¨ç©ºé—´ã€‚
    ç¼–ç å™¨å°†å›¾åƒåˆ†å‰²ä¸ºå¤šä¸ªè¡¥ä¸ï¼Œå¹¶é€šè¿‡ä¸€ç³»åˆ—å˜æ¢å—å¤„ç†è¿™äº›è¡¥ä¸ã€‚
    æœ€ç»ˆçš„ç¼–ç è¡¨ç¤ºé€šè¿‡ä¸€ä¸ªé¢ˆéƒ¨æ¨¡å—ç”Ÿæˆã€‚
    """

    def __init__(self, img_size: int = 1024, patch_size: int = 16, embed_dim: int = 768, depth: int = 12, out_chans: int = 256) -> None:
        """
        åˆå§‹åŒ–å›¾åƒç¼–ç å™¨çš„å‚æ•°ã€‚

        Args:
            img_size (int): è¾“å…¥å›¾åƒçš„å¤§å°ã€‚
            patch_size (int): è¡¥ä¸çš„å¤§å°ã€‚
            embed_dim (int): è¡¥ä¸åµŒå…¥çš„ç»´åº¦ã€‚
            depth (int): ViTçš„æ·±åº¦ï¼ˆå˜æ¢å—çš„æ•°é‡ï¼‰ã€‚
            out_chans (int): è¾“å‡ºé€šé“æ•°ã€‚
        """
        super().__init__()
        self.img_size = img_size

        # è¡¥ä¸åµŒå…¥æ¨¡å—
        self.patch_embed = PatchEmbed(
            kernel_size=(patch_size, patch_size),
            stride=(patch_size, patch_size),
            in_chans=3,  # å‡è®¾è¾“å…¥å›¾åƒä¸ºRGBå›¾åƒ
            embed_dim=embed_dim,
        )

        # å˜æ¢å—åˆ—è¡¨
        self.blocks = nn.ModuleList()
        for _ in range(depth):
            block = Block(dim=embed_dim)
            self.blocks.append(block)

        # é¢ˆéƒ¨æ¨¡å—ï¼Œç”¨äºè¿›ä¸€æ­¥å¤„ç†è¾“å‡º
        self.neck = nn.Sequential(
            nn.Conv2d(embed_dim, out_chans, kernel_size=1, bias=False),
            nn.LayerNorm(out_chans),
            nn.Conv2d(out_chans, out_chans, kernel_size=3, padding=1, bias=False),
            nn.LayerNorm(out_chans),
        )

    def forward(self, x: torch.Tensor) -> torch.Tensor:
        """å¤„ç†è¾“å…¥ï¼Œé€šè¿‡è¡¥ä¸åµŒå…¥ã€å˜æ¢å—å’Œé¢ˆéƒ¨æ¨¡å—ç”Ÿæˆè¾“å‡ºã€‚"""
        x = self.patch_embed(x)  # é€šè¿‡è¡¥ä¸åµŒå…¥å¤„ç†è¾“å…¥
        for blk in self.blocks:  # é€šè¿‡æ¯ä¸ªå˜æ¢å—å¤„ç†
            x = blk(x)
        return self.neck(x.permute(0, 3, 1, 2))  # è°ƒæ•´ç»´åº¦å¹¶é€šè¿‡é¢ˆéƒ¨æ¨¡å—è¾“å‡º


class PatchEmbed(nn.Module):
    """å›¾åƒåˆ°è¡¥ä¸åµŒå…¥çš„è½¬æ¢æ¨¡å—ã€‚"""

    def __init__(self, kernel_size: Tuple[int, int] = (16, 16), in_chans: int = 3, embed_dim: int = 768) -> None:
        """
        åˆå§‹åŒ–è¡¥ä¸åµŒå…¥æ¨¡å—ã€‚

        Args:
            kernel_size (Tuple): å·ç§¯æ ¸çš„å¤§å°ã€‚
            in_chans (int): è¾“å…¥å›¾åƒçš„é€šé“æ•°ã€‚
            embed_dim (int): è¡¥ä¸åµŒå…¥çš„ç»´åº¦ã€‚
        """
        super().__init__()
        # ä½¿ç”¨å·ç§¯å°†å›¾åƒè½¬æ¢ä¸ºè¡¥ä¸åµŒå…¥
        self.proj = nn.Conv2d(in_chans, embed_dim, kernel_size=kernel_size, stride=kernel_size)

    def forward(self, x: torch.Tensor) -> torch.Tensor:
        """è®¡ç®—è¡¥ä¸åµŒå…¥ï¼Œé€šè¿‡å·ç§¯å¹¶è°ƒæ•´ç»“æœå¼ é‡çš„ç»´åº¦ã€‚"""
        return self.proj(x).permute(0, 2, 3, 1)  # å°†è¾“å‡ºç»´åº¦è°ƒæ•´ä¸º[B, H, W, C]


class Block(nn.Module):
    """å˜æ¢å—ï¼ŒåŒ…å«å¤šå¤´æ³¨æ„åŠ›å’Œå‰é¦ˆç½‘ç»œã€‚"""

    def __init__(self, dim: int, num_heads: int = 8) -> None:
        """
        åˆå§‹åŒ–å˜æ¢å—ã€‚

        Args:
            dim (int): è¾“å…¥é€šé“æ•°ã€‚
            num_heads (int): æ³¨æ„åŠ›å¤´çš„æ•°é‡ã€‚
        """
        super().__init__()
        self.norm1 = nn.LayerNorm(dim)  # å½’ä¸€åŒ–å±‚
        self.attn = Attention(dim, num_heads)  # æ³¨æ„åŠ›æœºåˆ¶
        self.norm2 = nn.LayerNorm(dim)  # å½’ä¸€åŒ–å±‚
        self.mlp = MLPBlock(dim)  # å‰é¦ˆç½‘ç»œ

    def forward(self, x: torch.Tensor) -> torch.Tensor:
        """æ‰§è¡Œå˜æ¢å—çš„å‰å‘ä¼ æ’­ã€‚"""
        shortcut = x  # ä¿å­˜è¾“å…¥ä»¥è¿›è¡Œæ®‹å·®è¿æ¥
        x = self.norm1(x)  # å½’ä¸€åŒ–
        x = self.attn(x)  # åº”ç”¨æ³¨æ„åŠ›æœºåˆ¶
        x = shortcut + x  # æ®‹å·®è¿æ¥
        return x + self.mlp(self.norm2(x))  # é€šè¿‡å‰é¦ˆç½‘ç»œå¹¶è¿”å›


class Attention(nn.Module):
    """å¤šå¤´æ³¨æ„åŠ›æ¨¡å—ã€‚"""

    def __init__(self, dim: int, num_heads: int = 8) -> None:
        """
        åˆå§‹åŒ–æ³¨æ„åŠ›æ¨¡å—ã€‚

        Args:
            dim (int): è¾“å…¥é€šé“æ•°ã€‚
            num_heads (int): æ³¨æ„åŠ›å¤´çš„æ•°é‡ã€‚
        """
        super().__init__()
        self.num_heads = num_heads
        self.scale = (dim // num_heads) ** -0.5  # ç¼©æ”¾å› å­
        self.qkv = nn.Linear(dim, dim * 3)  # æŸ¥è¯¢ã€é”®ã€å€¼çš„çº¿æ€§å˜æ¢
        self.proj = nn.Linear(dim, dim)  # è¾“å‡ºçš„çº¿æ€§å˜æ¢

    def forward(self, x: torch.Tensor) -> torch.Tensor:
        """æ‰§è¡Œæ³¨æ„åŠ›æœºåˆ¶çš„å‰å‘ä¼ æ’­ã€‚"""
        B, H, W, _ = x.shape  # è·å–è¾“å…¥çš„å½¢çŠ¶
        qkv = self.qkv(x).reshape(B, H * W, 3, self.num_heads, -1).permute(2, 0, 3, 1, 4)  # è®¡ç®—qkv
        q, k, v = qkv.reshape(3, B * self.num_heads, H * W, -1).unbind(0)  # åˆ†ç¦»qã€kã€v
        attn = (q * self.scale) @ k.transpose(-2, -1)  # è®¡ç®—æ³¨æ„åŠ›æƒé‡
        attn = attn.softmax(dim=-1)  # å½’ä¸€åŒ–
        x = (attn @ v).view(B, self.num_heads, H, W, -1).permute(0, 2, 3, 1, 4).reshape(B, H, W, -1)  # è®¡ç®—è¾“å‡º
        return self.proj(x)  # é€šè¿‡çº¿æ€§å˜æ¢è¾“å‡º
```

### ä»£ç è¯´æ˜ï¼š
1. **ImageEncoderViT**: è¿™æ˜¯ä¸»è¦çš„å›¾åƒç¼–ç å™¨ç±»ï¼Œä½¿ç”¨ViTæ¶æ„å°†è¾“å…¥å›¾åƒç¼–ç ä¸ºæ½œåœ¨ç©ºé—´ã€‚å®ƒåŒ…å«è¡¥ä¸åµŒå…¥ã€å¤šä¸ªå˜æ¢å—å’Œä¸€ä¸ªé¢ˆéƒ¨æ¨¡å—ã€‚
2. **PatchEmbed**: è¯¥ç±»è´Ÿè´£å°†è¾“å…¥å›¾åƒåˆ†å‰²ä¸ºè¡¥ä¸å¹¶è¿›è¡ŒåµŒå…¥ï¼Œä½¿ç”¨å·ç§¯æ“ä½œå®ç°ã€‚
3. **Block**: å˜æ¢å—ï¼ŒåŒ…å«æ³¨æ„åŠ›æœºåˆ¶å’Œå‰é¦ˆç½‘ç»œï¼Œæ”¯æŒæ®‹å·®è¿æ¥ã€‚
4. **Attention**: å¤šå¤´æ³¨æ„åŠ›æ¨¡å—ï¼Œè®¡ç®—è¾“å…¥çš„æ³¨æ„åŠ›æƒé‡å¹¶ç”Ÿæˆè¾“å‡ºã€‚

è¿™äº›æ ¸å¿ƒéƒ¨åˆ†æ„æˆäº†å›¾åƒç¼–ç å™¨çš„åŸºç¡€ï¼Œèƒ½å¤Ÿæœ‰æ•ˆåœ°å¤„ç†å›¾åƒæ•°æ®å¹¶æå–ç‰¹å¾ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªç”¨äºå›¾åƒç¼–ç çš„æ¨¡å—ï¼Œä¸»è¦å®ç°äº†åŸºäºè§†è§‰å˜æ¢å™¨ï¼ˆVision Transformer, ViTï¼‰æ¶æ„çš„å›¾åƒç¼–ç å™¨ï¼Œä»¥åŠç”¨äºå¤„ç†ä¸åŒç±»å‹æç¤ºçš„ç¼–ç å™¨ã€‚æ–‡ä»¶ä¸­åŒ…å«å¤šä¸ªç±»ï¼Œä¸»è¦åŒ…æ‹¬`ImageEncoderViT`ã€`PromptEncoder`ã€`PositionEmbeddingRandom`ã€`Block`ã€`Attention`å’Œ`PatchEmbed`ã€‚

`ImageEncoderViT`ç±»æ˜¯å›¾åƒç¼–ç å™¨çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œå®ƒå°†è¾“å…¥å›¾åƒåˆ†å‰²æˆå¤šä¸ªå°å—ï¼ˆpatchesï¼‰ï¼Œå¹¶é€šè¿‡ä¸€ç³»åˆ—çš„å˜æ¢å—ï¼ˆtransformer blocksï¼‰è¿›è¡Œå¤„ç†ã€‚æ„é€ å‡½æ•°ä¸­å®šä¹‰äº†è¾“å…¥å›¾åƒçš„å¤§å°ã€æ¯ä¸ªå°å—çš„å¤§å°ã€è¾“å…¥é€šé“æ•°ã€åµŒå…¥ç»´åº¦ã€å˜æ¢å—çš„æ·±åº¦ã€æ³¨æ„åŠ›å¤´çš„æ•°é‡ç­‰å‚æ•°ã€‚å®ƒè¿˜åŒ…å«äº†ä¸€ä¸ªâ€œé¢ˆéƒ¨â€æ¨¡å—ï¼ˆneckï¼‰ï¼Œç”¨äºè¿›ä¸€æ­¥å¤„ç†ç¼–ç åçš„è¾“å‡ºã€‚`forward`æ–¹æ³•å®ç°äº†å›¾åƒçš„å‰å‘ä¼ æ’­è¿‡ç¨‹ï¼ŒåŒ…æ‹¬å°å—åµŒå…¥ã€ä½ç½®åµŒå…¥çš„åº”ç”¨ä»¥åŠé€šè¿‡å˜æ¢å—å’Œé¢ˆéƒ¨æ¨¡å—çš„å¤„ç†ã€‚

`PromptEncoder`ç±»ç”¨äºç¼–ç ä¸åŒç±»å‹çš„æç¤ºä¿¡æ¯ï¼Œå¦‚ç‚¹ã€æ¡†å’Œæ©ç ã€‚å®ƒç”Ÿæˆç¨€ç–å’Œå¯†é›†çš„åµŒå…¥ï¼Œä¾›åç»­çš„æ©ç è§£ç å™¨ä½¿ç”¨ã€‚æ„é€ å‡½æ•°ä¸­å®šä¹‰äº†åµŒå…¥ç»´åº¦ã€è¾“å…¥å›¾åƒçš„å¤§å°ã€æ©ç çš„è¾“å…¥é€šé“æ•°ç­‰å‚æ•°ï¼Œå¹¶åˆå§‹åŒ–äº†ç›¸å…³çš„åµŒå…¥å±‚å’Œä¸‹é‡‡æ ·ç½‘ç»œã€‚`forward`æ–¹æ³•å¤„ç†è¾“å…¥çš„ç‚¹ã€æ¡†å’Œæ©ç ï¼Œè¿”å›ç¨€ç–å’Œå¯†é›†çš„åµŒå…¥ã€‚

`PositionEmbeddingRandom`ç±»ç”¨äºç”Ÿæˆéšæœºç©ºé—´é¢‘ç‡çš„ä½ç½®ä¿¡æ¯ç¼–ç ï¼Œæä¾›äº†ä¸€ç§ä½ç½®ç¼–ç çš„æ–¹æ³•ï¼Œä»¥ä¾¿åœ¨å¤„ç†è¾“å…¥æ—¶è€ƒè™‘ç©ºé—´ä½ç½®ä¿¡æ¯ã€‚`Block`ç±»å®ç°äº†å˜æ¢å—çš„ç»“æ„ï¼ŒåŒ…å«äº†å½’ä¸€åŒ–å±‚ã€æ³¨æ„åŠ›æœºåˆ¶å’Œå¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰ã€‚`Attention`ç±»å®ç°äº†å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ï¼Œæ”¯æŒç›¸å¯¹ä½ç½®ç¼–ç ã€‚

`PatchEmbed`ç±»åˆ™è´Ÿè´£å°†è¾“å…¥å›¾åƒè½¬æ¢ä¸ºå°å—åµŒå…¥ï¼Œé€šè¿‡å·ç§¯æ“ä½œå®ç°å›¾åƒåˆ°å°å—çš„æ˜ å°„ã€‚æ•´ä½“æ¥çœ‹ï¼Œè¿™ä¸ªæ–‡ä»¶å®ç°äº†ä¸€ä¸ªå¼ºå¤§çš„å›¾åƒç¼–ç æ¡†æ¶ï¼Œç»“åˆäº†ç°ä»£æ·±åº¦å­¦ä¹ ä¸­çš„å¤šç§æŠ€æœ¯ï¼Œé€‚ç”¨äºå›¾åƒå¤„ç†å’Œè®¡ç®—æœºè§†è§‰ä»»åŠ¡ã€‚

### 12.ç³»ç»Ÿæ•´ä½“ç»“æ„ï¼ˆèŠ‚é€‰ï¼‰

### æ•´ä½“åŠŸèƒ½å’Œæ¶æ„æ¦‚æ‹¬

è¯¥é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäºYOLOv8çš„ç›®æ ‡æ£€æµ‹å’Œå›¾åƒå¤„ç†æ¡†æ¶ï¼Œä¸»è¦ç”¨äºè®­ç»ƒã€æ¨ç†å’Œå¯¹è±¡è·Ÿè¸ªã€‚å®ƒç»“åˆäº†æ·±åº¦å­¦ä¹ æŠ€æœ¯ï¼Œæä¾›äº†ä¸€ç³»åˆ—æ¨¡å—å’Œå·¥å…·ï¼Œæ”¯æŒæ•°æ®åŠ è½½ã€æ¨¡å‹è®­ç»ƒã€æ¨ç†ã€ç»“æœå¯è§†åŒ–å’Œå¯¹è±¡è·Ÿè¸ªç­‰åŠŸèƒ½ã€‚é¡¹ç›®çš„æ¶æ„åˆ†ä¸ºå¤šä¸ªæ¨¡å—ï¼ŒåŒ…æ‹¬æ•°æ®å¤„ç†ã€æ¨¡å‹å®šä¹‰ã€è®­ç»ƒæµç¨‹ã€æ¨ç†è¿‡ç¨‹å’Œå®ç”¨å·¥å…·ï¼Œæ—¨åœ¨ä¸ºç”¨æˆ·æä¾›ä¸€ä¸ªå®Œæ•´çš„è§£å†³æ–¹æ¡ˆï¼Œä»¥ä¾¿äºè¿›è¡Œç›®æ ‡æ£€æµ‹ä»»åŠ¡ã€‚

### æ–‡ä»¶åŠŸèƒ½æ•´ç†è¡¨

| æ–‡ä»¶è·¯å¾„                                                                                     | åŠŸèƒ½æè¿°                                                         |
|----------------------------------------------------------------------------------------------|------------------------------------------------------------------|
| `code/ultralytics/utils/callbacks/hub.py`                                                  | å®ç°ä¸Ultralytics HUBçš„äº¤äº’ï¼Œè®°å½•è®­ç»ƒè¿›åº¦å’Œä¸Šä¼ æ¨¡å‹æŒ‡æ ‡ã€‚      |
| `code/ui.py`                                                                                | é€šè¿‡Streamlitè¿è¡ŒæŒ‡å®šçš„è„šæœ¬ï¼Œå¤„ç†æ–‡ä»¶ä¸Šä¼ å’Œé”™è¯¯ç®¡ç†ã€‚          |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰/ultralytics/trackers/byte_tracker.py` | å®ç°å¯¹è±¡è·Ÿè¸ªåŠŸèƒ½ï¼Œç»“åˆå¡å°”æ›¼æ»¤æ³¢å™¨å’ŒYOLOæ£€æµ‹èƒ½åŠ›ã€‚              |
| `code/utils.py`                                                                             | æä¾›æ–‡ä»¶ä¸Šä¼ ã€æ£€æµ‹ç»“æœæ˜¾ç¤ºã€é»˜è®¤å›¾ç‰‡åŠ è½½å’Œæ‘„åƒå¤´æ£€æµ‹çš„å·¥å…·å‡½æ•°ã€‚ |
| `train.py`                                                                                  | è´Ÿè´£YOLOæ¨¡å‹çš„è®­ç»ƒï¼ŒåŒ…æ‹¬æ•°æ®é›†æ„å»ºã€æ¨¡å‹è®¾ç½®å’Œè®­ç»ƒç›‘æ§ã€‚       |
| `code/ultralytics/models/sam/modules/encoders.py`                                          | å®ç°å›¾åƒç¼–ç å™¨ï¼ŒåŸºäºè§†è§‰å˜æ¢å™¨æ¶æ„ï¼Œå¤„ç†å›¾åƒå’Œæç¤ºä¿¡æ¯ã€‚        |
| `code/ultralytics/models/yolo/segment/predict.py`                                          | å¤„ç†YOLOæ¨¡å‹çš„æ¨ç†è¿‡ç¨‹ï¼Œè¿›è¡Œç›®æ ‡æ£€æµ‹å’Œåˆ†å‰²ã€‚                    |
| `code/ultralytics/data/utils.py`                                                            | æä¾›æ•°æ®å¤„ç†å’Œå¢å¼ºçš„å·¥å…·å‡½æ•°ï¼Œæ”¯æŒæ•°æ®é›†çš„æ„å»ºå’Œç®¡ç†ã€‚          |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰/ultralytics/engine/predictor.py`  | å®ç°æ¨¡å‹æ¨ç†çš„ä¸»è¦é€»è¾‘ï¼Œå¤„ç†è¾“å…¥å¹¶è¿”å›æ£€æµ‹ç»“æœã€‚                |
| `code/ultralytics/data/dataset.py`                                                          | å®šä¹‰æ•°æ®é›†ç±»ï¼Œå¤„ç†æ•°æ®åŠ è½½å’Œé¢„å¤„ç†ã€‚                            |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰/ultralytics/utils/__init__.py`    | åˆå§‹åŒ–å·¥å…·æ¨¡å—ï¼Œå¯¼å…¥å…¶ä»–å·¥å…·å‡½æ•°å’Œç±»ã€‚                          |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰/ultralytics/utils/tal.py`        | æä¾›ä¸è®­ç»ƒå’Œæ¨ç†ç›¸å…³çš„è¾…åŠ©å‡½æ•°ï¼Œå¯èƒ½æ¶‰åŠæ¨¡å‹è¯„ä¼°å’Œç»“æœå¤„ç†ã€‚    |
| `code/ultralytics/nn/modules/__init__.py`                                                  | åˆå§‹åŒ–ç¥ç»ç½‘ç»œæ¨¡å—ï¼Œå¯¼å…¥ç›¸å…³çš„ç½‘ç»œç»“æ„å’Œå±‚ã€‚                    |

è¿™ä¸ªè¡¨æ ¼æ€»ç»“äº†æ¯ä¸ªæ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½ï¼Œå¸®åŠ©ç†è§£æ•´ä¸ªé¡¹ç›®çš„ç»“æ„å’Œå„ä¸ªæ¨¡å—ä¹‹é—´çš„å…³ç³»ã€‚

æ³¨æ„ï¼šç”±äºæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰â€ä¸­éƒ¨åˆ†ä»£ç å¯èƒ½ä¼šä¼˜åŒ–å‡çº§ï¼Œä»…ä¾›å‚è€ƒå­¦ä¹ ï¼Œå®Œæ•´â€œè®­ç»ƒæºç â€ã€â€œWebå‰ç«¯ç•Œé¢â€å’Œâ€œ70+ç§åˆ›æ–°ç‚¹æºç â€ä»¥â€œ13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–â€çš„å†…å®¹ä¸ºå‡†ã€‚

### 13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–

![19.png](19.png)


# [ä¸‹è½½é“¾æ¥ï¼šhttps://mbd.pub/o/bread/ZpuWmZxv](https://mbd.pub/o/bread/ZpuWmZxv)